<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>LUXE: PASARAN v4.0</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto+Mono:wght@300;400;500&display=swap" rel="stylesheet"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.css/all.min.css"/>
<style>
:root {
  --primary: #6c5ce7;
  --secondary: #a29bfe;
  --accent: #fd79a8;
  --success: #00b894;
  --warning: #fdcb6e;
  --dark: #2d3436;
  --darker: #1e272e;
  --light: #dfe6e9;
  --card-bg: rgba(255, 255, 255, 0.1);
  --text: #ffffff;
  --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
  --bg-gradient: linear-gradient(135deg, #1e272e 0%, #2d3436 100%);
}

[data-theme="light"] {
  --primary: #6c5ce7;
  --secondary: #786fa6;
  --accent: #e84393;
  --success: #05c46b;
  --warning: #ffa801;
  --dark: #f5f6fa;
  --darker: #dcdde1;
  --light: #2d3436;
  --card-bg: rgba(255, 255, 255, 0.9);
  --text: #2d3436;
  --bg-gradient: linear-gradient(135deg, #dfe6e9 0%, #f5f6fa 100%);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Montserrat', sans-serif;
  background: var(--bg-gradient);
  color: var(--text);
  line-height: 1.7;
  padding: 20px;
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
  transition: background 0.5s ease, color 0.5s ease;
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: url('https://images.unsplash.com/photo-1531297484001-80022131f5a1?ixlib=rb-1.2.1&auto=format&fit=crop&w=2000&q=80');
  opacity: 0.1;
  z-index: -1;
}

/* Header */
.header-container {
  text-align: center;
  margin: 30px auto 40px;
  max-width: 900px;
  position: relative;
}

.header {
  font-family: 'Montserrat', sans-serif;
  font-size: 3.2rem;
  font-weight: 700;
  color: var(--text);
  letter-spacing: 2px;
  position: relative;
  display: inline-block;
  margin-bottom: 15px;
  text-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
}

.header::after {
  content: '';
  position: absolute;
  bottom: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 100px;
  height: 4px;
  background: linear-gradient(to right, var(--primary), var(--accent));
  border-radius: 2px;
}

.status {
  font-size: 1rem;
  color: var(--success);
  margin-top: 15px;
  letter-spacing: 1px;
  background: rgba(0, 184, 148, 0.1);
  padding: 8px 20px;
  border-radius: 20px;
  display: inline-block;
  border: 1px solid rgba(0, 184, 148, 0.3);
}

/* Dashboard Grid */
.dashboard-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 30px;
  max-width: 1200px;
  margin: 0 auto;
}

@media (max-width: 968px) {
  .dashboard-grid {
    grid-template-columns: 1fr;
    gap: 25px;
  }
}

/* Card Styles */
.card {
  background: var(--card-bg);
  backdrop-filter: blur(12px);
  border-radius: 20px;
  padding: 30px;
  position: relative;
  overflow: hidden;
  transition: var(--transition);
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
  border: 1px solid rgba(255, 255, 255, 0.1);
  animation: fadeIn 0.5s ease-out;
}

.card:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
}

.card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(108, 92, 231, 0.1) 0%, rgba(253, 121, 168, 0.1) 100%);
  z-index: -1;
}

.card-title {
  font-family: 'Montserrat', sans-serif;
  font-size: 1.5rem;
  font-weight: 600;
  margin-bottom: 25px;
  display: flex;
  align-items: center;
  color: var(--light);
}

.card-title i {
  margin-right: 15px;
  font-size: 1.8rem;
  color: var(--primary);
}

/* Next Draw Card */
.next-draw-content {
  text-align: center;
}

.next-name {
  font-family: 'Montserrat', sans-serif;
  font-size: 2rem;
  font-weight: 700;
  margin: 15px 0;
  color: var(--light);
}

.next-time {
  font-size: 1.1rem;
  margin-bottom: 10px;
  color: var(--secondary);
  font-family: 'Roboto Mono', monospace;
}

.countdown {
  font-family: 'Roboto Mono', monospace;
  font-size: 2.5rem;
  font-weight: 500;
  margin: 20px 0;
  letter-spacing: 2px;
  color: var(--warning);
  text-shadow: 0 0 10px rgba(253, 203, 110, 0.3);
}

.next-desc {
  font-size: 0.95rem;
  opacity: 0.9;
  line-height: 1.6;
  color: var(--secondary);
}

/* Result Indicator */
.result-indicator {
  display: inline-block;
  padding: 10px 25px;
  border-radius: 25px;
  font-size: 0.9rem;
  margin-top: 20px;
  font-weight: 500;
  transition: var(--transition);
}

.result-waiting {
  background: rgba(253, 203, 110, 0.15);
  color: var(--warning);
  border: 1px solid rgba(253, 203, 110, 0.3);
}

.result-available {
  background: rgba(0, 184, 148, 0.15);
  color: var(--success);
  border: 1px solid rgba(0, 184, 148, 0.3);
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0% { box-shadow: 0 0 0 0 rgba(0, 184, 148, 0.3); }
  70% { box-shadow: 0 0 0 10px rgba(0, 184, 148, 0); }
  100% { box-shadow: 0 0 0 0 rgba(0, 184, 148, 0); }
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

/* Pasaran Selection */
.select-wrapper {
  position: relative;
  margin: 20px 0;
}

.select-wrapper::after {
  content: "â–¼";
  font-size: 12px;
  color: var(--primary);
  position: absolute;
  right: 20px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}

select {
  width: 100%;
  padding: 16px 20px;
  background: rgba(255, 255, 255, 0.08);
  color: var(--text);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  font-family: 'Montserrat', sans-serif;
  font-size: 1rem;
  outline: none;
  cursor: pointer;
  appearance: none;
  transition: var(--transition);
}

select:hover, select:focus {
  background: rgba(255, 255, 255, 0.12);
  border-color: var(--primary);
}

/* Output Box */
#output {
  background: rgba(255, 255, 255, 0.08);
  color: var(--text);
  padding: 25px;
  border-left: 4px solid var(--primary);
  border-radius: 12px;
  font-size: 1rem;
  white-space: pre-line;
  min-height: 120px;
  display: none;
  margin: 25px 0;
  transition: var(--transition);
  line-height: 1.6;
  font-family: 'Roboto Mono', monospace;
  animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateX(-20px); }
  to { opacity: 1; transform: translateX(0); }
}

/* Buttons */
.btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: 15px 30px;
  background: var(--primary);
  color: white;
  text-decoration: none;
  border: none;
  border-radius: 12px;
  font-weight: 600;
  transition: var(--transition);
  cursor: pointer;
  margin-top: 15px;
  font-family: 'Montserrat', sans-serif;
  box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3);
}

.btn:hover {
  background: #5d4ae0;
  transform: translateY(-2px);
  box-shadow: 0 7px 20px rgba(108, 92, 231, 0.4);
}

.btn i {
  margin-right: 10px;
}

.btn-secondary {
  background: transparent;
  border: 2px solid var(--primary);
  color: var(--primary);
  box-shadow: none;
}

.btn-secondary:hover {
  background: rgba(108, 92, 231, 0.1);
}

/* Audio Control */
.audio-control {
  position: fixed;
  bottom: 25px;
  right: 25px;
  z-index: 100;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.audio-control:hover {
  background: rgba(255, 255, 255, 0.15);
  transform: translateY(-3px);
}

.audio-control i {
  font-size: 24px;
  color: var(--primary);
}

/* Theme Toggle */
.theme-toggle {
  position: fixed;
  bottom: 25px;
  left: 25px;
  z-index: 100;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  cursor: pointer;
  transition: var(--transition);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.theme-toggle:hover {
  background: rgba(255, 255, 255, 0.15);
  transform: translateY(-3px);
}

.theme-toggle i {
  font-size: 24px;
  color: var(--primary);
}

/* Notification Modal */
.notif-modal {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.7);
  z-index: 9998;
  display: none;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(8px);
  animation: fadeIn 0.3s ease-out;
}

.notif-box {
  background: var(--darker);
  border-radius: 20px;
  padding: 35px;
  text-align: center;
  max-width: 450px;
  color: var(--text);
  font-family: 'Montserrat', sans-serif;
  box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.1);
  animation: scaleIn 0.3s ease-out;
}

@keyframes scaleIn {
  from { transform: scale(0.9); opacity: 0; }
  to { transform: scale(1); opacity: 1; }
}

.notif-title {
  color: var(--primary);
  font-size: 1.8rem;
  font-weight: 700;
  margin-bottom: 15px;
}

.notif-content {
  margin-top: 15px;
  font-size: 1.1rem;
  line-height: 1.6;
  color: var(--light);
}

.notif-content span {
  display: block;
  margin-bottom: 8px;
}

/* Live Badge */
.live-badge {
  position: fixed;
  top: 25px;
  right: 25px;
  background: var(--success);
  color: white;
  padding: 8px 20px;
  border-radius: 20px;
  font-size: 0.9rem;
  font-weight: 600;
  z-index: 100;
  display: flex;
  align-items: center;
  box-shadow: 0 5px 15px rgba(0, 184, 148, 0.3);
  animation: pulse 2s infinite;
}

.live-badge i {
  margin-right: 8px;
}

/* Floating Elements */
.floating-element {
  position: fixed;
  width: 200px;
  height: 200px;
  border-radius: 50%;
  opacity: 0.05;
  z-index: -1;
  filter: blur(40px);
}

.floating-1 {
  background: var(--primary);
  top: 15%;
  left: 10%;
  animation: float 15s infinite ease-in-out;
}

.floating-2 {
  background: var(--accent);
  bottom: 15%;
  right: 10%;
  animation: float 18s infinite ease-in-out reverse;
}

@keyframes float {
  0%, 100% { transform: translate(0, 0) rotate(0deg); }
  25% { transform: translate(20px, -20px) rotate(5deg); }
  50% { transform: translate(-15px, 15px) rotate(-5deg); }
  75% { transform: translate(-20px, -15px) rotate(3deg); }
}

/* Toast Notification */
.toast {
  position: fixed;
  bottom: 100px;
  right: 25px;
  background: var(--darker);
  color: var(--text);
  padding: 15px 25px;
  border-radius: 12px;
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
  z-index: 1000;
  display: flex;
  align-items: center;
  animation: slideInRight 0.3s ease-out;
  border-left: 4px solid var(--success);
}

@keyframes slideInRight {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}

.toast.hide {
  animation: slideOutRight 0.3s ease-out forwards;
}

@keyframes slideOutRight {
  from { transform: translateX(0); opacity: 1; }
  to { transform: translateX(100%); opacity: 0; }
}

.toast i {
  margin-right: 10px;
  color: var(--success);
}

/* Responsive */
@media (max-width: 768px) {
  .header {
    font-size: 2.5rem;
  }
  
  .dashboard-grid {
    grid-template-columns: 1fr;
    gap: 25px;
  }
  
  .card {
    padding: 25px;
  }
  
  .next-name {
    font-size: 1.8rem;
  }
  
  .countdown {
    font-size: 2rem;
  }
  
  .audio-control, .theme-toggle {
    bottom: 20px;
    width: 50px;
    height: 50px;
  }
  
  .audio-control {
    right: 20px;
  }
  
  .theme-toggle {
    left: 20px;
  }
  
  .live-badge {
    top: 20px;
    right: 20px;
    font-size: 0.8rem;
    padding: 6px 15px;
  }
  
  .floating-element {
    width: 150px;
    height: 150px;
  }
  
  .toast {
    bottom: 90px;
    right: 15px;
    left: 15px;
  }
}
</style>
</head>
<body>

<!-- Floating Elements -->
<div class="floating-element floating-1"></div>
<div class="floating-element floating-2"></div>

<!-- Live Badge -->
<div class="live-badge">
  <i class="fas fa-broadcast-tower"></i> LIVE
</div>

<!-- Header -->
<div class="header-container">
  <div class="header">LUXE PASARAN</div>
  <div class="status">STATUS: <span style="color:#00ff00">ONLINE</span> | MODE: REAL-TIME</div>
</div>

<!-- Dashboard Grid -->
<div class="dashboard-grid">
  <!-- Next Draw Card -->
  <div class="card">
    <div class="card-title"><i class="fas fa-clock"></i> NEXT DRAW</div>
    <div class="next-draw-content">
      <div class="next-name" id="nextName">Loading...</div>
      <div class="next-time" id="nextTime">-</div>
      <div class="countdown" id="countdown">00:00:00</div>
      <div class="result-indicator result-waiting" id="resultIndicator">
        <i class="fas fa-clock"></i> MENUNGGU RESULT
      </div>
      <div class="next-desc" id="nextDesc">Menghitung pasaran berikutnya...</div>
    </div>
  </div>

  <!-- Selection Card -->
  <div class="card">
    <div class="card-title"><i class="fas fa-list"></i> PILIH PASARAN</div>
    <div class="select-wrapper">
      <select id="pasaran" onchange="runRobot()">
        <option value="">-- PILIH PASARAN --</option>
        <option value="HOKIDRAW">HOKIDRAW</option>
        <option value="toto_macau_pagi">TOTO_MACAU_PAGI</option>
        <option value="hua_hin_0100">HUAHIN_0100</option>
        <option value="kentucky_midday">KENTUCKY_MIDDAY</option>
        <option value="florida_midday">FLORIDA_MIDDAY</option>
        <option value="bangkok_0130">BANGKOK_0130</option>
        <option value="new_york_midday">NEW_YORK_MIDDAY</option>
        <option value="carolina_day">CAROLINA_DAY</option>
        <option value="brunei_02">BRUNEI_02</option>
        <option value="oregon_03">OREGON_03</option>
        <option value="oregon_06">OREGON_06</option>
        <option value="california">CALIFORNIA</option>
        <option value="florida_evening">FLORIDA_EVENING</option>
        <option value="oregon_09">OREGON_09</option>
        <option value="bangkok_0930">BANGKOK_0930</option>
        <option value="new_york_evening">NEW_YORK_EVENING</option>
        <option value="kentucky_evening">KENTUCKY_EVENING</option>
        <option value="carolina_evening">CAROLINA_EVENING</option>
        <option value="toto_cambodia">TOTO_CAMBODIA</option>
        <option value="chelsea_11">CHELSEA_11</option>
        <option value="oregon_12">OREGON_12</option>
        <option value="bullseye">BULLSEYE</option>
        <option value="poipet_12">POIPET_12</option>
        <option value="toto_macau_siang">TOTO_MACAU_SIANG</option>
        <option value="sydney">SYDNEY</option>
        <option value="jakarta_1400">JAKARTA_1400</option>
        <option value="brunei_14">BRUNEI_14</option>
        <option value="chelsea_15">CHELSEA_15</option>
        <option value="toto_macau_5d_sore">TOTO_MACAU_5D_SORE</option>
        <option value="poipet_15">POIPET_15</option>
        <option value="toto_mali_1530">TOTO_MALI_1530</option>
        <option value="toto_macau_sore">TOTO_MACAU_SORE</option>
        <option value="hua_hin_1630">HUAHIN_1630</option>
        <option value="kingkong_4d_sore">KINGKONG_4D_SORE</option>
        <option value="singapore_pools">SINGAPORE_POOLS</option>
        <option value="magnum4d_pools">MAGNUM4D_POOLS</option>
        <option value="chelsea_19">CHELSEA_19</option>
        <option value="toto_macau_malam_I">TOTO_MACAU_MALAM_I</option>
        <option value="poipet_19">POIPET_19</option>
        <option value="pcso">PCSO</option>
        <option value="toto_mali_2030">TOTO_MALI_2030</option>
        <option value="hua_hin_2100">HUAHIN_2100</option>
        <option value="chelsea_21">CHELSEA_21</option>
        <option value="toto_macau_5d_malam">TOTO_MACAU_5D_MALAM</option>
        <option value="nevada">NEVADA</option>
        <option value="brunei_21">BRUNEI_21</option>
        <option value="toto_macau_malam_II">TOTO_MACAU_MALAM_II</option>
        <option value="poipet_22">POIPET_22</option>
        <option value="hongkong">HONGKONG</option>
        <option value="toto_macau_malam_III">TOTO_MACAU_MALAM_III</option>
        <option value="toto_mali_2330">TOTO_MALI_2330</option>
        <option value="jakarta_2330">JAKARTA_2330</option>
        <option value="kingkong_4d_malam">KINGKONG_4D_MALAM</option>
      </select>
    </div>

    <div id="output"></div>
    <button class="btn" id="copyBtn" onclick="copyToClipboard()">
      <i class="fas fa-copy"></i> COPY TO CLIPBOARD
    </button>
    <button class="btn btn-secondary" id="testSoundBtn" onclick="testAllSounds()">
      <i class="fas fa-volume-up"></i> TEST SOUND
    </button>
  </div>
</div>

<!-- Audio Control -->
<div class="audio-control" id="audioControl">
  <i class="fas fa-volume-up"></i>
</div>

<!-- Theme Toggle -->
<div class="theme-toggle" id="themeToggle">
  <i class="fas fa-moon"></i>
</div>

<!-- Notification Modal -->
<div class="notif-modal" id="notifModal">
  <div class="notif-box">
    <div class="notif-title">ðŸ”” RESULT TELAH KELUAR!</div>
    <div class="notif-content">
      <span id="notifPasaran">Pasaran</span>
      <span>Result telah tersedia. Silakan periksa!</span>
    </div>
    <button class="btn" style="margin-top: 20px;" onclick="closeNotif()">
      <i class="fas fa-check"></i> MENGERTI
    </button>
  </div>
</div>

<script>
// =============== VARIABEL GLOBAL ===============
let audioUnlocked = false;
let globalVolume = 0.7;
let lastPlayedTime = 0;
let resultCheckInterval;
const soundCooldown = 300; // ms
let lastResultState = {};
let isLightTheme = false;

// =============== SOUND EFFECTS ===============
const soundLibrary = {
  select: "https://assets.mixkit.co/sfx/preview/mixkit-select-click-1109.mp3",
  confirm: "https://assets.mixkit.co/sfx/preview/mixkit-confirmation-tone-2867.mp3",
  alert: "https://assets.mixkit.co/sfx/preview/mixkit-alarm-digital-clock-beep-989.mp3",
  beep: "https://assets.mixkit.co/sfx/preview/mixkit-beep-space-alarm-3084.mp3",
  click: "https://assets.mixkit.co/sfx/preview/mixkit-mouse-click-close-1113.mp3",
  result: "https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3",
  notification: "https://assets.mixkit.co/sfx/preview/mixkit-positive-notification-951.mp3",
  success: "https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3",
  error: "https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3",
  theme: "https://assets.mixkit.co/sfx/preview/mixkit-magic-sparkles-3001.mp3"
};

// =============== PLAY SOUND FUNCTION ===============
function playSound(soundName, vol = 1) {
  if (!audioUnlocked) return;
  
  // Cooldown untuk mencegah spam suara
  const now = Date.now();
  if (now - lastPlayedTime < soundCooldown) return;
  lastPlayedTime = now;
  
  const audio = new Audio(soundLibrary[soundName]);
  audio.volume = globalVolume * vol;
  audio.play().catch(err => console.warn("Gagal mainkan suara:", err));
  return audio;
}

// =============== TEST ALL SOUNDS ===============
function testAllSounds() {
  if (!audioUnlocked) {
    showToast("Aktifkan suara terlebih dahulu", "error");
    return;
  }
  
  let delay = 0;
  Object.keys(soundLibrary).forEach(sound => {
    setTimeout(() => playSound(sound, 0.6), delay);
    delay += 500;
  });
  
  showToast("Memutar semua efek suara", "success");
}

// =============== SHOW TOAST NOTIFICATION ===============
function showToast(message, type = "success") {
  // Hapus toast sebelumnya jika ada
  const existingToast = document.querySelector('.toast');
  if (existingToast) {
    existingToast.classList.add('hide');
    setTimeout(() => existingToast.remove(), 300);
  }
  
  // Buat toast baru
  const toast = document.createElement('div');
  toast.className = `toast ${type}`;
  
  const icon = type === "success" ? "fa-check-circle" : "fa-exclamation-circle";
  toast.innerHTML = `
    <i class="fas ${icon}"></i>
    <span>${message}</span>
  `;
  
  document.body.appendChild(toast);
  
  // Hapus toast setelah 3 detik
  setTimeout(() => {
    toast.classList.add('hide');
    setTimeout(() => toast.remove(), 300);
  }, 3000);
}

// =============== AUDIO CONTROL ===============
const audioControl = document.getElementById("audioControl");
const audioIcon = audioControl.querySelector("i");

audioControl.addEventListener("click", function() {
  if (audioUnlocked) {
    // Matikan suara
    audioUnlocked = false;
    audioIcon.className = "fas fa-volume-mute";
    localStorage.setItem("audioUnlocked", "false");
    playSound('click', 0.5);
    showToast("Suara dinonaktifkan", "success");
  } else {
    // Hidupkan suara
    const silentAudio = new Audio("data:audio/wav;base64,UklGRnoAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAAABMYXZmNTguODkuMTAw");
    silentAudio.play().then(() => {
      audioUnlocked = true;
      audioIcon.className = "fas fa-volume-up";
      localStorage.setItem("audioUnlocked", "true");
      playSound('beep', 0.5);
      showToast("Suara diaktifkan", "success");
    }).catch(err => {
      console.warn("Gagal unlock audio:", err);
      showToast("Izin suara diperlukan untuk notifikasi", "error");
    });
  }
});

// =============== THEME TOGGLE ===============
const themeToggle = document.getElementById("themeToggle");
const themeIcon = themeToggle.querySelector("i");

themeToggle.addEventListener("click", function() {
  isLightTheme = !isLightTheme;
  
  if (isLightTheme) {
    document.documentElement.setAttribute('data-theme', 'light');
    themeIcon.className = "fas fa-sun";
    localStorage.setItem("theme", "light");
    playSound('theme', 0.5);
    showToast("Mode terang diaktifkan", "success");
  } else {
    document.documentElement.removeAttribute('data-theme');
    themeIcon.className = "fas fa-moon";
    localStorage.setItem("theme", "dark");
    playSound('theme', 0.5);
    showToast("Mode gelap diaktifkan", "success");
  }
});

// =============== DAFTAR PASARAN ===============
const pasaranList = [
  { key: "HOKIDRAW", name: "HOKIDRAW", result: "setiap jam", desc: "Result 24 kali dalam sehari dan result keluar per 1 jam sekali ya bosku serta setelah livedraw selesai dilakukan sekitar menit 10-15 ya bosku." },
  { key: "toto_macau_pagi", name: "TOTO_MACAU_PAGI", result: "00:15", desc: "Tutup Pukul 00:00 WIB, Result Pukul 00:15 WIB." },
  { key: "hua_hin_0100", name: "HUAHIN_0100", result: "01:00", desc: "Tutup Pukul 00:45 WIB, Result Pukul 01:00 WIB." },
  { key: "kentucky_midday", name: "KENTUCKY_MIDDAY", result: "00:20", desc: "Tutup Pukul 00:05 WIB, Result Pukul 00:20 WIB." },
  { key: "florida_midday", name: "FLORIDA_MIDDAY", result: "00:30", desc: "Tutup Pukul 00:20 WIB, Result Pukul 00:30 WIB." },
  { key: "bangkok_0130", name: "BANGKOK_0130", result: "01:30", desc: "Tutup Pukul 01:15 WIB, Result Pukul 01:30 WIB." },
  { key: "new_york_midday", name: "NEW_YORK_MIDDAY", result: "01:25", desc: "Tutup Pukul 01:15 WIB, Result Pukul 01:25 WIB." },
  { key: "carolina_day", name: "CAROLINA_DAY", result: "02:00", desc: "Tutup Pukul 01:45 WIB, Result Pukul 02:00 WIB." },
  { key: "brunei_02", name: "BRUNEI_02", result: "02:45", desc: "Tutup Pukul 02:30 WIB, Result Pukul 02:45 WIB." },
  { key: "oregon_03", name: "OREGON_03", result: "03:00", desc: "Tutup Pukul 02:50 WIB, Result Pukul 03:00 WIB." },
  { key: "oregon_06", name: "OREGON_06", result: "06:00", desc: "Tutup Pukul 05:50 WIB, Result Pukul 06:00 WIB." },
  { key: "california", name: "CALIFORNIA", result: "08:30", desc: "Tutup Pukul 08:25 WIB, Result Pukul 08:30 WIB." },
  { key: "florida_evening", name: "FLORIDA_EVENING", result: "08:45", desc: "Tutup Pukul 08:35 WIB, Result Pukul 08:45 WIB." },
  { key: "oregon_09", name: "OREGON_09", result: "09:00", desc: "Tutup Pukul 08:50 WIB, Result Pukul 09:00 WIB." },
  { key: "bangkok_0930", name: "BANGKOK_0930", result: "09:30", desc: "Tutup Pukul 09:15 WIB, Result Pukul 09:30 WIB." },
  { key: "new_york_evening", name: "NEW_YORK_EVENING", result: "09:35", desc: "Tutup Pukul 09:25 WIB, Result Pukul 09:35 WIB." },
  { key: "kentucky_evening", name: "KENTUCKY_EVENING", result: "10:00", desc: "Tutup Pukul 09:45 WIB, Result Pukul 10:00 WIB." },
  { key: "carolina_evening", name: "CAROLINA_EVENING", result: "10:22", desc: "Tutup Pukul 10:17 WIB, Result Pukul 10:22 WIB." },
  { key: "toto_cambodia", name: "TOTO_CAMBODIA", result: "11:00", desc: "Tutup Pukul 10:45 WIB, Result Pukul 11:00 WIB." },
  { key: "chelsea_11", name: "CHELSEA_11", result: "11:15", desc: "Tutup Pukul 11:00 WIB, Result Pukul 11:15 WIB." },
  { key: "oregon_12", name: "OREGON_12", result: "12:00", desc: "Tutup Pukul 11:50 WIB, Result Pukul 12:00 WIB." },
  { key: "bullseye", name: "BULLSEYE", result: "13:15", desc: "Tutup Pukul 13:00 WIB, Result Pukul 13:15 WIB." },
  { key: "poipet_12", name: "POIPET_12", result: "12:30", desc: "Tutup Pukul 12:15 WIB, Result Pukul 12:30 WIB." },
  { key: "toto_macau_siang", name: "TOTO_MACAU_SIANG", result: "13:15", desc: "Tutup Pukul 13:00 WIB, Result Pukul 13:15 WIB." },
  { key: "sydney", name: "SYDNEY", result: "14:05", desc: "Tutup Pukul 13:49 WIB, Result Pukul 14:05 WIB." },
  { key: "jakarta_1400", name: "JAKARTA_1400", result: "14:10", desc: "Tutup Pukul 13:55 WIB, Result Pukul 14:10 WIB." },
  { key: "brunei_14", name: "BRUNEI_14", result: "14:45", desc: "Tutup Pukul 14:30 WIB, Result Pukul 14:45 WIB." },
  { key: "chelsea_15", name: "CHELSEA_15", result: "15:15", desc: "Tutup Pukul 15:00 WIB, Result Pukul 15:15 WIB." },
  { key: "toto_macau_5d_sore", name: "TOTO_MACAU_5D_SORE", result: "15:30", desc: "Tutup Pukul 15:15 WIB, Result Pukul 15:30 WIB." },
  { key: "poipet_15", name: "POIPET_15", result: "15:30", desc: "Tutup Pukul 15:15 WIB, Result Pukul 15:30 WIB." },
  { key: "toto_mali_1530", name: "TOTO_MALI_1530", result: "15:30", desc: "Tutup Pukul 15:15 WIB, Result Pukul 15:30 WIB." },
  { key: "toto_macau_sore", name: "TOTO_MACAU_SORE", result: "16:15", desc: "Tutup Pukul 16:00 WIB, Result Pukul 16:15 WIB." },
  { key: "hua_hin_1630", name: "HUAHIN_1630", result: "16:30", desc: "Tutup Pukul 16:15 WIB, Result Pukul 16:30 WIB." },
  { key: "kingkong_4d_sore", name: "KINGKONG_4D_SORE", result: "16:51", desc: "Tutup Pukul 16:48 WIB, Result Pukul 16:51 WIB." },
  { key: "singapore_pools", name: "SINGAPORE_POOLS", result: "17:45", desc: "Tutup Pukul 17:30 WIB, Result Pukul 17:45 WIB." },
  { key: "magnum4d_pools", name: "MAGNUM4D_POOLS", result: "18:40", desc: "Tutup Pukul 18:10 WIB, Result Pukul 18:40 WIB." },
  { key: "chelsea_19", name: "CHELSEA_19", result: "19:15", desc: "Tutup Pukul 19:00 WIB, Result Pukul 19:15 WIB." },
  { key: "toto_macau_malam_I", name: "TOTO_MACAU_MALAM_I", result: "19:15", desc: "Tutup Pukul 19:00 WIB, Result Pukul 19:15 WIB." },
  { key: "poipet_19", name: "POIPET_19", result: "19:45", desc: "Tutup Pukul 19:30 WIB, Result Pukul 19:45 WIB." },
  { key: "pcso", name: "PCSO", result: "20:10", desc: "Tutup Pukul 19:50 WIB, Result Pukul 20:10 WIB." },
  { key: "toto_mali_2030", name: "TOTO_MALI_2030", result: "20:30", desc: "Tutup Pukul 20:15 WIB, Result Pukul 20:30 WIB." },
  { key: "hua_hin_2100", name: "HUAHIN_2100", result: "21:00", desc: "Tutup Pukul 20:45 WIB, Result Pukul 21:00 WIB." },
  { key: "chelsea_21", name: "CHELSEA_21", result: "21:15", desc: "Tutup Pukul 21:00 WIB, Result Pukul 21:15 WIB." },
  { key: "toto_macau_5d_malam", name: "TOTO_MACAU_5D_MALAM", result: "21:30", desc: "Tutup Pukul 21:15 WIB, Result Pukul 21:30 WIB." },
  { key: "nevada", name: "NEVADA", result: "21:30", desc: "Tutup Pukul 21:15 WIB, Result Pukul 21:30 WIB." },
  { key: "brunei_21", name: "BRUNEI_21", result: "21:45", desc: "Tutup Pukul 21:30 WIB, Result Pukul 21:45 WIB." },
  { key: "toto_macau_malam_II", name: "TOTO_MACAU_MALAM_II", result: "22:15", desc: "Tutup Pukul 22:00 WIB, Result Pukul 22:15 WIB." },
  { key: "poipet_22", name: "POIPET_22", result: "22:45", desc: "Tutup Pukul 22:30 WIB, Result Pukul 22:45 WIB." },
  { key: "hongkong", name: "HONGKONG", result: "23:15", desc: "Tutup Pukul 22:59 WIB, Result Pukul 23:15 WIB." },
  { key: "toto_macau_malam_III", name: "TOTO_MACAU_MALAM_III", result: "23:15", desc: "Tutup Pukul 23:00 WIB, Result Pukul 23:15 WIB." },
  { key: "toto_mali_2330", name: "TOTO_MALI_2330", result: "23:30", desc: "Tutup Pukul 23:15 WIB, Result Pukul 23:30 WIB." },
  { key: "jakarta_2330", name: "JAKARTA_2330", result: "23:40", desc: "Tutup Pukul 23:25 WIB, Result Pukul 23:40 WIB." },
  { key: "kingkong_4d_malam", name: "KINGKONG_4D_MALAM", result: "23:45", desc: "Tutup Pukul 23:30 WIB, Result Pukul 23:45 WIB." }
];

const jadwal = {};
pasaranList.forEach(p => {
  jadwal[p.key] = `Pasaran : ${p.name}\n${p.desc}`;
});

let currentText = "";

function runRobot() {
  const value = document.getElementById("pasaran").value;
  const output = document.getElementById("output");
  const copyBtn = document.getElementById("copyBtn");

  if (!value) {
    output.style.display = "none";
    copyBtn.style.display = "none";
    return;
  }

  // Play sound effect
  playSound('select', 0.7);
  
  currentText = jadwal[value];
  output.textContent = currentText;
  output.style.display = "block";
  copyBtn.style.display = "inline-block";

  localStorage.setItem("lastPasaran", value);
  
  // Tampilkan notifikasi toast
  const selectedPasaran = pasaranList.find(p => p.key === value);
  if (selectedPasaran) {
    showToast(`Memilih pasaran ${selectedPasaran.name}`, "success");
  }
}

function copyToClipboard() {
  if (!currentText) return;

  const textarea = document.createElement("textarea");
  textarea.value = currentText;
  document.body.appendChild(textarea);
  textarea.select();
  document.execCommand("copy");
  document.body.removeChild(textarea);

  playSound('confirm', 0.6);
  showToast("Teks berhasil disalin ke clipboard", "success");

  const btn = document.getElementById("copyBtn");
  const original = btn.innerHTML;
  btn.innerHTML = '<i class="fas fa-check"></i> COPIED!';

  setTimeout(() => btn.innerHTML = original, 1500);
}

// =============== FUNGSI PENGECEKAN RESULT ===============
function checkIfResultAvailable() {
  const now = new Date();
  const currentTime = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();
  
  pasaranList.forEach(pasaran => {
    if (pasaran.result !== "setiap jam") {
      const [h, m] = pasaran.result.split(':').map(Number);
      const resultTime = h * 3600 + m * 60;
      
      // Jika waktu saat ini 5 menit setelah result time
      if (currentTime >= resultTime && currentTime <= resultTime + 300) {
        // Jika result belum pernah diumumkan untuk pasaran ini
        if (!lastResultState[pasaran.key] || lastResultState[pasaran.key] < now.getDate()) {
          // Tandai result sudah diumumkan hari ini
          lastResultState[pasaran.key] = now.getDate();
          
          // Tampilkan notifikasi
          showResultNotification(pasaran.name);
        }
      }
    }
  });
}

function showResultNotification(pasaranName) {
  const notifModal = document.getElementById("notifModal");
  const notifPasaran = document.getElementById("notifPasaran");
  
  notifPasaran.textContent = pasaranName;
  notifModal.style.display = "flex";
  
  // Mainkan suara notifikasi
  playSound('result', 0.8);
  
  // Update UI untuk menunjukkan result tersedia
  const resultIndicator = document.getElementById("resultIndicator");
  resultIndicator.className = "result-indicator result-available";
  resultIndicator.innerHTML = `<i class="fas fa-check-circle"></i> RESULT TERSEDIA`;
  
  // Tampilkan notifikasi browser jika didukung
  if ("Notification" in window && Notification.permission === "granted") {
    new Notification("ðŸ”” RESULT TELAH KELUAR!", {
      body: `Result untuk ${pasaranName} telah tersedia. Silakan periksa!`,
      icon: "https://example.com/icon.png", // Ganti dengan URL ikon Anda
      tag: "pasaran-result"
    });
  }
  
  // Sembunyikan notifikasi setelah 5 detik
  setTimeout(() => {
    notifModal.style.display = "none";
  }, 5000);
}

function closeNotif() {
  document.getElementById("notifModal").style.display = "none";
  playSound('click', 0.5);
}

// =============== UPDATE NEXT DRAW ===============
function updateNextDraw() {
  const now = new Date();
  const currentSec = now.getHours() * 3600 + now.getMinutes() * 60 + now.getSeconds();

  let next = null;
  let minDiff = Infinity;

  pasaranList
    .filter(p => p.result !== "setiap jam")
    .forEach(p => {
      const [h, m] = p.result.split(':').map(Number);
      const resultSec = h * 3600 + m * 60;
      let diff = resultSec - currentSec;
      if (diff < 0) diff += 86400;

      if (diff < minDiff) {
        minDiff = diff;
        next = p;
      }
    });

  if (next) {
    const h = Math.floor(minDiff / 3600);
    const m = Math.floor((minDiff % 3600) / 60);
    const s = minDiff % 60;

    document.getElementById("nextName").textContent = next.name;
    document.getElementById("nextTime").textContent = `RESULT: ${next.result} WIB`;
    document.getElementById("countdown").textContent = `${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
    document.getElementById("nextDesc").textContent = next.desc;
  }
}

// =============== INISIALISASI ===============
window.addEventListener("load", () => {
  updateNextDraw();
  const last = localStorage.getItem("lastPasaran");
  if (last) document.getElementById("pasaran").value = last;
  
  // Cek status audio
  if (localStorage.getItem("audioUnlocked") === "true") {
    audioUnlocked = true;
    audioIcon.className = "fas fa-volume-up";
  } else {
    audioUnlocked = false;
    audioIcon.className = "fas fa-volume-mute";
  }
  
  // Cek tema
  if (localStorage.getItem("theme") === "light") {
    isLightTheme = true;
    document.documentElement.setAttribute('data-theme', 'light');
    themeIcon.className = "fas fa-sun";
  }
  
  // Minta izin notifikasi
  if ("Notification" in window && Notification.permission === "default") {
    Notification.requestPermission();
  }
  
  // Update countdown setiap detik
  setInterval(updateNextDraw, 1000);
  
  // Cek result setiap 10 detik
  resultCheckInterval = setInterval(checkIfResultAvailable, 10000);
  
  // Play welcome sound
  setTimeout(() => playSound('beep', 0.3), 1000);
});

// =============== NOTIFIKASI OTOMATIS ===============
const notifModal = document.getElementById("notifModal");

notifModal.addEventListener("click", (e) => {
  if (e.target === notifModal) {
    notifModal.style.display = "none";
    playSound('click', 0.5);
  }
});

document.querySelector('.notif-box').addEventListener('click', e => e.stopPropagation());
</script>
</body>
</html>



