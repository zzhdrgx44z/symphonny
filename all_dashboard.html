<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TOMMY HILFIGER // EDITORIAL</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500&family=Oswald:wght@500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
/* =============== VARIABEL EDITORIAL =============== */
:root {
--bg-paper: #fdfbf7; /* Creamy Paper */
--bg-card: #ffffff;
--text-ink: #1a1a1a;
--text-light: #666666;
--accent-red: #e4002b; /* Tommy Red */
--accent-navy: #002347; /* Tommy Navy */
--accent-green: #009688; /* Hijau Aman (Teal Green) */
--border-subtle: #e0e0e0;
--shadow-paper: 0 4px 20px rgba(0,0,0,0.05);
}

/* =============== RESET & BASE =============== */
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
background-color: var(--bg-paper);
color: var(--text-ink);
font-family: 'Inter', sans-serif;
height: 100vh;
display: flex;
overflow: hidden;
}

/* =============== BENTO LAYOUT =============== */
.wrapper {
display: grid;
grid-template-columns: 80px 1fr;
width: 100%;
height: 100%;
}

/* =============== SIDEBAR STRIP =============== */
.bento-sidebar {
background: var(--bg-card);
border-right: 1px solid var(--border-subtle);
display: flex;
flex-direction: column;
align-items: center;
padding-top: 30px;
}

.logo-box {
width: 40px; height: 40px;
background: var(--text-ink);
color: #fff;
display: flex;
justify-content: center;
align-items: center;
font-family: 'Oswald', sans-serif;
font-weight: 700;
margin-bottom: 50px;
}

.nav-strip {
display: flex;
flex-direction: column;
gap: 30px;
}

.nav-dot {
width: 12px; height: 12px;
border-radius: 50%;
background: #ddd;
cursor: pointer;
transition: 0.3s;
position: relative;
}

.nav-dot:hover { transform: scale(1.5); background: var(--accent-red); }
.nav-dot.active { background: var(--text-ink); transform: scale(1.5); }

/* Tooltip for nav */
.nav-dot::after {
content: attr(data-label);
position: absolute;
left: 20px; top: -5px;
background: var(--text-ink);
color: #fff;
padding: 5px 10px;
font-size: 10px;
text-transform: uppercase;
opacity: 0;
pointer-events: none;
transition: 0.2s;
border-radius: 4px;
white-space: nowrap;
font-family: 'Oswald';
}

.nav-dot:hover::after { opacity: 1; left: 25px; }

/* =============== MAIN GRID =============== */
.main-area {
padding: 40px;
overflow-y: auto;
display: flex;
flex-direction: column;
gap: 30px;
}

/* Header */
.header-grid {
display: flex;
justify-content: space-between;
align-items: flex-end;
border-bottom: 2px solid var(--text-ink);
padding-bottom: 20px;
}

.page-title {
font-family: 'Oswald', sans-serif;
font-size: 4rem;
text-transform: uppercase;
line-height: 0.9;
color: var(--text-ink);
}

.page-subtitle {
font-family: 'Inter', sans-serif;
text-transform: uppercase;
letter-spacing: 2px;
color: var(--accent-navy);
font-weight: 700;
font-size: 0.9rem;
text-align: right;
}

/* Views */
.view-section { display: none; animation: fadeEditorial 0.6s ease; }
.view-section.active { display: block; }
@keyframes fadeEditorial { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* =============== COMPONENTS =============== */

/* Search Hero */
.hero-search {
width: 100%;
padding: 0;
border: none;
border-bottom: 2px solid var(--border-subtle);
background: transparent;
font-family: 'Oswald', sans-serif;
font-size: 2rem;
color: var(--text-ink);
outline: none;
margin-bottom: 40px;
transition: 0.3s;
}

.hero-search:focus {
border-bottom-color: var(--accent-red);
}

.hero-search::placeholder { color: #ccc; text-transform: uppercase; }

/* Bento Stats */
.stats-container {
display: grid;
grid-template-columns: repeat(3, 1fr);
gap: 20px;
margin-bottom: 40px;
}

.stat-card {
background: var(--bg-card);
border: 1px solid var(--border-subtle);
padding: 30px;
position: relative;
overflow: hidden;
}

.stat-card::before {
content: '';
position: absolute;
top: 0; left: 0; width: 100%; height: 4px;
background: var(--text-ink);
}

.stat-card:hover::before { background: var(--accent-red); }

/* Style khusus untuk kartu Status AMAN */
.stat-card.status-safe {
border: 1px solid var(--accent-green);
}
.stat-card.status-safe::before {
background: var(--accent-green);
}

.stat-val {
font-family: 'Oswald', sans-serif;
font-size: 3.5rem;
font-weight: 500;
color: var(--text-ink);
line-height: 1;
}

/* Hijau untuk teks aman */
.stat-val.text-green {
color: var(--accent-green);
}

.stat-lbl {
font-size: 0.75rem;
text-transform: uppercase;
letter-spacing: 1px;
margin-top: 10px;
color: var(--text-light);
}

/* Table Styling (Editorial) */
.editorial-table {
width: 100%;
border-collapse: collapse;
}

.editorial-table thead th {
text-align: left;
padding: 20px 10px;
font-family: 'Oswald', sans-serif;
font-size: 1.2rem;
text-transform: uppercase;
border-bottom: 2px solid var(--border-subtle);
color: var(--accent-navy);
}

.editorial-table tbody td {
padding: 20px 10px;
border-bottom: 1px solid var(--border-subtle);
font-size: 0.95rem;
color: var(--text-ink);
vertical-align: middle;
}

.editorial-table tr:hover td {
background-color: #f7f7f7;
color: var(--accent-red);
}

/* Buttons */
.btn-editorial {
background: var(--text-ink);
color: #fff;
border: none;
padding: 12px 25px;
font-family: 'Oswald', sans-serif;
text-transform: uppercase;
letter-spacing: 1px;
cursor: pointer;
transition: 0.3s;
}

.btn-editorial:hover {
background: var(--accent-red);
transform: translateY(-2px);
}

.btn-outline {
background: transparent;
border: 2px solid var(--text-ink);
color: var(--text-ink);
padding: 10px 20px;
font-family: 'Oswald', sans-serif;
text-transform: uppercase;
cursor: pointer;
transition: 0.3s;
}

.btn-outline:hover {
background: var(--text-ink);
color: #fff;
}

/* Chart Area */
.chart-grid {
display: grid;
grid-template-columns: 2fr 1fr;
gap: 20px;
}

.chart-box {
background: var(--bg-card);
border: 1px solid var(--border-subtle);
padding: 30px;
min-height: 300px;
display: flex;
align-items: flex-end;
justify-content: space-around;
padding-bottom: 50px;
}

.bar-vertical {
width: 40px;
background: #eee;
transition: 0.3s;
}
.bar-vertical:hover { background: var(--accent-navy); }

/* Toast */
.toast-editorial {
position: fixed; bottom: 30px; right: 30px;
background: var(--text-ink);
color: #fff;
padding: 15px 30px;
font-family: 'Oswald', sans-serif;
text-transform: uppercase;
letter-spacing: 1px;
box-shadow: 0 10px 30px rgba(0,0,0,0.1);
z-index: 100;
animation: slideUp 0.4s ease;
}
@keyframes slideUp { from { transform: translateY(50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

/* Mobile */
@media (max-width: 768px) {
.wrapper { grid-template-columns: 1fr; }
.bento-sidebar { display: none; }
.header-grid { flex-direction: column; align-items: flex-start; }
.page-subtitle { text-align: left; margin-top: 10px; }
.stats-container { grid-template-columns: 1fr; }
.chart-grid { grid-template-columns: 1fr; }
.page-title { font-size: 2.5rem; }
}
</style>
</head>
<body>

<div class="wrapper">
    <!-- Sidebar Strip -->
    <aside class="bento-sidebar">
        <div class="logo-box">TH</div>
        <nav class="nav-strip">
            <div class="nav-dot active" data-label="Data" onclick="showDashboard(); setActiveNav(this)"></div>
            <div class="nav-dot" data-label="Stats" onclick="showAnalytics(); setActiveNav(this)"></div>
        </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-area">
        
        <!-- VIEW 1: DATABASE -->
        <div id="dashboardView" class="view-section active">
            <div class="header-grid">
                <div>
                    <div class="page-subtitle">System Archive</div>
                    <div class="page-title">The <br>Collection</div>
                </div>
                <div style="text-align: right;">
                    <button class="btn-outline" onclick="loadData()"><i class="fas fa-sync"></i> Refresh</button>
                </div>
            </div>

            <input type="text" class="hero-search" id="searchInput" placeholder="Search items..." onkeypress="handleEnter(event)">

            <table class="editorial-table" id="tableContainer">
                <!-- Data -->
            </table>
        </div>

        <!-- VIEW 2: ANALYTICS -->
        <div id="analyticsView" class="view-section">
            <div class="header-grid">
                <div>
                    <div class="page-subtitle">Performance</div>
                    <div class="page-title">The <br>Numbers</div>
                </div>
            </div>

            <div class="stats-container">
                <div class="stat-card">
                    <div class="stat-val" id="analyticsTotal">0</div>
                    <div class="stat-lbl">Total Items</div>
                </div>
                <div class="stat-card">
                    <div class="stat-val">100%</div>
                    <div class="stat-lbl">Sync Rate</div>
                </div>
                <!-- Status Aman (Updated) -->
                <div class="stat-card status-safe">
                    <div class="stat-val text-green">AMAN</div>
                    <div class="stat-lbl">System Status</div>
                </div>
            </div>

            <div class="chart-grid">
                <div class="chart-box">
                    <div class="bar-vertical" style="height: 40%;"></div>
                    <div class="bar-vertical" style="height: 70%;"></div>
                    <div class="bar-vertical" style="height: 50%; background: var(--accent-navy);"></div>
                    <div class="bar-vertical" style="height: 90%;"></div>
                    <div class="bar-vertical" style="height: 60%;"></div>
                </div>
                <div class="stat-card" style="display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center;">
                    <div style="font-size:1rem; text-transform:uppercase; margin-bottom:10px;">Traffic</div>
                    <div style="font-family:'Oswald'; font-size:3rem; color:var(--accent-red);">HIGH</div>
                </div>
            </div>
        </div>

    </main>
</div>

<!-- TOAST STACK -->
<div id="toastStack"></div>

<script>
// ================= JS LOGIC =================
let semuaData = { linknawala: [] };
let filteredData = { linknawala: [] };

// Config
const config = {
    spreadsheetId: '19AodSFSw4shpSZVZ4I-_sD91eU1HPITMeg4cwLiEV1c',
    sheetGid: '1202906531',
    gasUrl: 'https://script.google.com/macros/s/AKfycbwkHrgiGlxFkJHZwp-bMaRCezwCSPAdV-FyUHkX9cAEWu/exec'
};

window.onload = function() {
    muatSemuaData();
};

function showDashboard() {
    document.getElementById('dashboardView').classList.add('active');
    document.getElementById('analyticsView').classList.remove('active');
}

function showAnalytics() {
    document.getElementById('dashboardView').classList.remove('active');
    document.getElementById('analyticsView').classList.add('active');
    document.getElementById('analyticsTotal').innerText = (semuaData.linknawala.length - 1);
}

function setActiveNav(el) {
    document.querySelectorAll('.nav-dot').forEach(n => n.classList.remove('active'));
    el.classList.add('active');
}

function showToast(msg) {
    const container = document.getElementById('toastStack');
    const t = document.createElement('div');
    t.className = 'toast-editorial';
    t.innerText = msg.toUpperCase();
    container.appendChild(t);
    setTimeout(() => { t.remove(); }, 3000);
}

function copyText(text) {
    if (!text) return;
    navigator.clipboard.writeText(text).then(() => showToast("Data Copied"));
}

function handleEnter(e) { if(e.key === 'Enter') performSearch(); }

// Data Logic
async function muatSemuaData() {
    const container = document.getElementById('tableContainer');
    container.innerHTML = `<tr><td colspan="5" style="text-align:center; padding:40px; font-family:'Oswald'; letter-spacing:2px;">LOADING DATA...</td></tr>`;
    try {
        let dataFetched = false;
        if (config.gasUrl) {
            try {
                const res = await fetch(config.gasUrl);
                if(res.ok) {
                    const json = await res.json();
                    if(json.success) {
                        semuaData.linknawala = json.linknawala || [];
                        dataFetched = true;
                    }
                }
            } catch(e){}
        }
        if(!dataFetched) {
            const csvUrl = `https://docs.google.com/spreadsheets/d/${config.spreadsheetId}/export?format=csv&gid=${config.sheetGid}`;
            const res = await fetch(csvUrl);
            if(!res.ok) throw new Error('Connection Failed');
            const csvText = await res.text();
            semuaData.linknawala = parseCSV(csvText);
        }
        filteredData.linknawala = JSON.parse(JSON.stringify(semuaData.linknawala));
        renderTable();
        const totalElem = document.getElementById('analyticsTotal');
        if(totalElem) totalElem.innerText = (semuaData.linknawala.length - 1);
    } catch(err) {
        container.innerHTML = `<tr><td colspan="5" style="text-align:center; color:var(--accent-red); font-family:'Oswald';">CONNECTION ERROR</td></tr>`;
    }
}

function loadData() { muatSemuaData(); }

function parseCSV(text) {
    if(!text) return [];
    return text.split('\n').filter(l => l.trim()).map(row => {
        let cur = '', arr = [], inQuote = false;
        for(let char of row) {
            if(char === '"') inQuote = !inQuote;
            else if(char === ',' && !inQuote) { arr.push(cur.trim()); cur = ''; }
            else cur += char;
        }
        arr.push(cur.trim());
        return arr;
    });
}

function renderTable() {
    const data = filteredData.linknawala;
    const container = document.getElementById('tableContainer');
    if(!data || data.length === 0) { container.innerHTML = '<tr><td colspan="5" style="text-align:center; padding:40px; color:var(--text-light);">No Data Available</td></tr>'; return; }

    let html = `<thead><tr>`;
    if(data[0]) {
        data[0].forEach(h => html += `<th>${h}</th>`);
        html += `<th></th>`; 
        html += `</tr></thead><tbody>`;
        for(let i=1; i<data.length; i++) {
            if(!data[i]) continue;
            html += `<tr>`;
            let firstText = '';
            data[i].forEach((cell, idx) => {
                if(idx >= 4) return; 
                const val = cell || '-';
                if(idx === 0) {
                    firstText = val;
                    html += `<td style="font-family:'Oswald'; font-weight:500;">${val}</td>`;
                }
                else if(idx === 1) html += `<td style="font-family:'Inter'; font-size:0.8rem; text-transform:uppercase; color:var(--text-light);">${val}</td>`;
                else html += `<td style="color:#444;">${val}</td>`;
            });
            html += `<td><button class="btn-editorial" style="padding:5px 10px; font-size:0.7rem;" onclick="copyText('${firstText.replace(/'/g, "\\'")}')">COPY</button></td>`;
            html += `</tr>`;
        }
    }
    html += `</tbody>`;
    container.innerHTML = html;
}

function performSearch() {
    const term = document.getElementById('searchInput').value.toLowerCase().trim();
    const original = semuaData.linknawala;
    if(!term) {
        filteredData.linknawala = JSON.parse(JSON.stringify(original));
    } else {
        const filtered = [original[0]];
        for(let i=1; i<original.length; i++) {
            if(original[i].some(cell => cell && cell.toString().toLowerCase().includes(term))) {
                filtered.push(original[i]);
            }
        }
        filteredData.linknawala = filtered;
    }
    renderTable();
}
</script>
</body>
</html>
