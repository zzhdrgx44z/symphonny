<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TOMMY HILFIGER - Enhanced Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Rajdhani:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
/* =============== VARIABEL WARNA & DESAIN =============== */
:root {
  --primary: #00ffff;
  --primary-dark: #00cccc;
  --secondary: #ff00ff;
  --secondary-dark: #cc00cc;
  --accent: #00ff88;
  --accent-dark: #00cc66;
  --warning: #ffaa00;
  --success: #00ff00;
  --danger: #ff3366;
  --dark: #0a0a0f;
  --darker: #05050a;
  --panel: rgba(10, 15, 30, 0.95);
  --panel-light: rgba(15, 25, 40, 0.85);
  --glass: rgba(255, 255, 255, 0.05);
  --border-color: rgba(0, 255, 255, 0.2);
  --text-primary: #ffffff;
  --text-secondary: #b0c4ff;
  --text-muted: #8090b0;
  --shadow-glow: 0 0 20px rgba(0, 255, 255, 0.3);
  --shadow-card: 0 10px 30px rgba(0, 0, 0, 0.3);
}

/* =============== RESET & BASE STYLES =============== */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  scroll-behavior: smooth;
}

body {
  display: flex;
  min-height: 100vh;
  color: var(--text-primary);
  font-family: 'Rajdhani', sans-serif;
  background: 
    radial-gradient(ellipse at top left, rgba(0, 50, 100, 0.3) 0%, transparent 50%),
    radial-gradient(ellipse at bottom right, rgba(100, 0, 150, 0.3) 0%, transparent 50%),
    linear-gradient(135deg, #0a0a0f 0%, #0a0a1f 50%, #0a0515 100%);
  overflow-x: hidden;
  position: relative;
}

/* Animated Background */
body::before {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: 
    radial-gradient(circle at 20% 30%, rgba(0, 150, 255, 0.1) 0%, transparent 20%),
    radial-gradient(circle at 80% 70%, rgba(255, 0, 255, 0.1) 0%, transparent 20%),
    radial-gradient(circle at 50% 50%, rgba(0, 255, 136, 0.05) 0%, transparent 30%);
  animation: backgroundPulse 10s ease-in-out infinite;
  pointer-events: none;
  z-index: -2;
}

body::after {
  content: "";
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: 
    repeating-linear-gradient(
      0deg,
      transparent,
      transparent 2px,
      rgba(0, 255, 255, 0.02) 2px,
      rgba(0, 255, 255, 0.02) 4px
    );
  pointer-events: none;
  z-index: -1;
  animation: scanlines 8s linear infinite;
}

@keyframes backgroundPulse {
  0%, 100% { opacity: 0.5; }
  50% { opacity: 1; }
}

@keyframes scanlines {
  0% { transform: translateY(0); }
  100% { transform: translateY(10px); }
}

/* =============== ENHANCED SIDEBAR =============== */
.sidebar-future {
  width: 320px;
  height: 100vh;
  background: linear-gradient(180deg, 
    rgba(5, 10, 20, 0.98) 0%, 
    rgba(10, 15, 30, 0.95) 50%, 
    rgba(5, 10, 20, 0.98) 100%);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border-right: 1px solid var(--border-color);
  box-shadow: 
    4px 0 30px rgba(0, 255, 255, 0.2),
    inset -1px 0 0 rgba(255, 255, 255, 0.05);
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: 100;
  overflow: hidden;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Sidebar Collapsed State */
.sidebar-future.collapsed {
  width: 80px;
}

.sidebar-future.collapsed .robot-header h2,
.sidebar-future.collapsed .robot-subtitle,
.sidebar-future.collapsed .robot-nav ul li a span,
.sidebar-future.collapsed .robot-footer .sys-line {
  display: none;
}

.sidebar-future.collapsed .robot-header {
  padding: 20px 10px;
}

.sidebar-future.collapsed .robot-nav ul li a {
  justify-content: center;
  padding: 14px;
}

.sidebar-future.collapsed .robot-footer {
  padding: 10px;
}

/* Sidebar Toggle Button */
.sidebar-toggle {
  position: absolute;
  top: 20px;
  right: -15px;
  width: 30px;
  height: 30px;
  background: var(--panel);
  border: 1px solid var(--border-color);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--primary);
  cursor: pointer;
  z-index: 101;
  transition: all 0.3s ease;
  box-shadow: 0 0 10px rgba(0, 255, 255, 0.3);
}

.sidebar-toggle:hover {
  background: var(--primary);
  color: var(--dark);
  transform: scale(1.1);
  box-shadow: 0 0 20px var(--primary);
}

/* Sidebar Glow Effect */
.sidebar-future::before {
  content: "";
  position: absolute;
  top: 0;
  right: 0;
  width: 1px;
  height: 100%;
  background: linear-gradient(180deg, 
    transparent, 
    var(--primary), 
    transparent);
  animation: sidebarGlow 3s ease-in-out infinite;
}

@keyframes sidebarGlow {
  0%, 100% { opacity: 0.3; box-shadow: 0 0 10px var(--primary); }
  50% { opacity: 1; box-shadow: 0 0 30px var(--primary); }
}

/* Sidebar Header */
.robot-header {
  padding: 30px 20px;
  text-align: center;
  position: relative;
  background: linear-gradient(135deg, var(--glass), transparent);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.robot-header::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 10%;
  width: 80%;
  height: 1px;
  background: linear-gradient(90deg, 
    transparent, 
    var(--primary), 
    transparent);
  animation: headerLine 3s ease-in-out infinite;
}

@keyframes headerLine {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 1; }
}

.robot-header h2 {
  font-family: 'Orbitron', sans-serif;
  font-size: 2rem;
  font-weight: 900;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 30px rgba(0, 255, 255, 0.5);
  letter-spacing: 2px;
  margin-bottom: 8px;
  animation: titleGlow 2s ease-in-out infinite alternate;
}

@keyframes titleGlow {
  0% { filter: brightness(1); }
  100% { filter: brightness(1.2); }
}

.robot-subtitle {
  font-size: 0.85rem;
  color: var(--text-secondary);
  text-transform: uppercase;
  letter-spacing: 3px;
  margin-bottom: 15px;
}

.status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 8px 16px;
  background: rgba(0, 255, 136, 0.1);
  border: 1px solid rgba(0, 255, 136, 0.3);
  border-radius: 20px;
  font-size: 0.9rem;
  color: var(--accent);
  animation: statusPulse 2s ease-in-out infinite;
}

@keyframes statusPulse {
  0%, 100% { 
    box-shadow: 0 0 10px rgba(0, 255, 136, 0.3);
    transform: scale(1);
  }
  50% { 
    box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
    transform: scale(1.05);
  }
}

.status-indicator .dot {
  width: 8px;
  height: 8px;
  background: var(--accent);
  border-radius: 50%;
  box-shadow: 0 0 10px var(--accent);
  animation: dotPulse 1.5s ease-in-out infinite;
}

@keyframes dotPulse {
  0%, 100% { opacity: 1; transform: scale(1); }
  50% { opacity: 0.7; transform: scale(1.2); }
}

/* Enhanced Navigation */
.robot-nav {
  flex: 1;
  overflow-y: auto;
  padding: 20px 0;
  scrollbar-width: thin;
  scrollbar-color: var(--border-color) transparent;
}

.robot-nav::-webkit-scrollbar {
  width: 4px;
}

.robot-nav::-webkit-scrollbar-track {
  background: transparent;
}

.robot-nav::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 2px;
}

.robot-nav ul {
  list-style: none;
  padding: 0 15px;
}

.robot-nav ul li {
  margin-bottom: 8px;
  position: relative;
}

.robot-nav ul li::before {
  content: "";
  position: absolute;
  left: 0;
  top: 50%;
  transform: translateY(-50%);
  width: 3px;
  height: 0;
  background: linear-gradient(180deg, var(--primary), var(--secondary));
  transition: height 0.3s ease;
  border-radius: 2px;
}

.robot-nav ul li:hover::before,
.robot-nav ul li.active::before {
  height: 70%;
}

.robot-nav ul li a {
  position: relative;
  display: flex;
  align-items: center;
  gap: 15px;
  padding: 14px 18px;
  color: var(--text-secondary);
  text-decoration: none;
  font-size: 1rem;
  font-weight: 500;
  border-radius: 12px;
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
  background: var(--glass);
  border: 1px solid transparent;
}

.robot-nav ul li a::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, 
    transparent, 
    rgba(0, 255, 255, 0.1), 
    transparent);
  transition: left 0.5s ease;
}

.robot-nav ul li a:hover::before {
  left: 100%;
}

.robot-nav ul li a i {
  font-size: 1.2rem;
  min-width: 24px;
  text-align: center;
  transition: all 0.3s ease;
  color: var(--primary);
}

.robot-nav ul li a span {
  position: relative;
  z-index: 1;
  transition: color 0.3s ease;
}

.robot-nav ul li a:hover {
  background: rgba(0, 255, 255, 0.1);
  color: var(--text-primary);
  transform: translateX(5px);
  border: 1px solid rgba(0, 255, 255, 0.3);
  box-shadow: 0 5px 15px rgba(0, 255, 255, 0.2);
}

.robot-nav ul li a:hover i {
  color: var(--accent);
  transform: scale(1.1) rotate(5deg);
}

.robot-nav ul li.active a {
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.15), 
    rgba(255, 0, 255, 0.1));
  color: var(--text-primary);
  border: 1px solid var(--border-color);
  box-shadow: 0 5px 20px rgba(0, 255, 255, 0.3);
}

.robot-nav ul li.active a i {
  color: var(--accent);
}

/* Sidebar Footer */
.robot-footer {
  padding: 20px;
  text-align: center;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  background: linear-gradient(135deg, var(--glass), transparent);
}

.robot-footer .sys-line {
  font-size: 0.8rem;
  color: var(--text-muted);
  margin-bottom: 10px;
  font-family: 'Space Mono', monospace;
}

.robot-footer .sys-line span {
  color: var(--secondary);
  font-weight: 700;
}

.core-pulse {
  width: 12px;
  height: 12px;
  background: radial-gradient(circle, var(--primary), var(--primary-dark));
  border-radius: 50%;
  margin: 0 auto;
  box-shadow: 0 0 20px var(--primary);
  animation: corePulse 2s ease-in-out infinite;
}

@keyframes corePulse {
  0%, 100% { 
    transform: scale(1);
    box-shadow: 0 0 20px var(--primary);
  }
  50% { 
    transform: scale(1.3);
    box-shadow: 0 0 30px var(--primary), 0 0 50px rgba(0, 255, 255, 0.5);
  }
}

/* =============== MAIN CONTENT AREA =============== */
.konten-utama {
  flex: 1;
  padding: 30px;
  display: flex;
  flex-direction: column;
  align-items: center;
  position: relative;
  overflow-y: auto;
  min-height: 100vh;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Header Section */
.header {
  width: 100%;
  max-width: 1200px;
  margin-bottom: 40px;
  position: relative;
}

.header-animasi {
  position: relative;
  height: 100px;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 30px;
  overflow: hidden;
}

.header-animasi::before {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 2px;
  background: linear-gradient(90deg, 
    transparent, 
    var(--primary), 
    transparent);
  animation: scanHeader 3s linear infinite;
}

@keyframes scanHeader {
  0% { left: -100%; }
  100% { left: 100%; }
}

#teksSelamatDatang {
  font-family: 'Orbitron', monospace;
  font-size: 2.5rem;
  font-weight: 700;
  background: linear-gradient(135deg, var(--primary), var(--accent));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  text-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
  animation: textGlow 2s ease-in-out infinite alternate;
  letter-spacing: 3px;
  text-transform: uppercase;
  position: relative;
}

#teksSelamatDatang::before,
#teksSelamatDatang::after {
  content: "";
  position: absolute;
  width: 50px;
  height: 2px;
  background: var(--primary);
  top: 50%;
  animation: sideLines 2s ease-in-out infinite;
}

#teksSelamatDatang::before {
  left: -70px;
}

#teksSelamatDatang::after {
  right: -70px;
}

@keyframes sideLines {
  0%, 100% { opacity: 0.3; width: 30px; }
  50% { opacity: 1; width: 50px; }
}

@keyframes textGlow {
  0% { filter: brightness(1) drop-shadow(0 0 10px rgba(0, 255, 255, 0.5)); }
  100% { filter: brightness(1.2) drop-shadow(0 0 20px rgba(0, 255, 255, 0.8)); }
}

/* Enhanced Search Box */
#kotakPencarian {
  width: 100%;
  max-width: 600px;
  height: 55px;
  padding: 0 25px 0 55px;
  border: 2px solid var(--border-color);
  border-radius: 30px;
  background: linear-gradient(135deg, var(--panel), var(--panel-light));
  color: var(--text-primary);
  font-family: 'Space Mono', monospace;
  font-size: 16px;
  outline: none;
  transition: all 0.3s ease;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='20' height='20' viewBox='0 0 24 24' fill='none' stroke='%2300ffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: 20px center;
  box-shadow: 
    inset 0 2px 10px rgba(0, 0, 0, 0.3),
    0 5px 20px rgba(0, 0, 0, 0.2);
}

#kotakPencarian::placeholder {
  color: var(--text-muted);
  font-style: italic;
}

#kotakPencarian:focus {
  border-color: var(--primary);
  box-shadow: 
    inset 0 2px 10px rgba(0, 255, 255, 0.2),
    0 0 30px rgba(0, 255, 255, 0.3),
    0 5px 20px rgba(0, 0, 0, 0.3);
  transform: translateY(-2px);
}

/* =============== INFO CARDS =============== */
.info-container {
  display: flex;
  justify-content: center;
  gap: 30px;
  width: 100%;
  max-width: 1200px;
  margin: 30px 0;
  flex-wrap: wrap;
}

.info-card {
  flex: 1;
  min-width: 280px;
  max-width: 350px;
  display: flex;
  align-items: center;
  padding: 25px;
  background: linear-gradient(135deg, var(--panel), var(--panel-light));
  border: 1px solid var(--border-color);
  border-radius: 20px;
  box-shadow: var(--shadow-card);
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
}

.info-card::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.05), 
    transparent);
  opacity: 0;
  transition: opacity 0.3s ease;
}

.info-card:hover::before {
  opacity: 1;
}

.info-card:hover {
  transform: translateY(-5px) scale(1.02);
  border-color: var(--primary);
  box-shadow: 
    0 15px 40px rgba(0, 255, 255, 0.2),
    0 5px 20px rgba(0, 0, 0, 0.3);
}

.card-icon {
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.1), 
    rgba(255, 0, 255, 0.1));
  border-radius: 15px;
  margin-right: 20px;
  font-size: 1.8rem;
  color: var(--primary);
  transition: all 0.3s ease;
}

.info-card:hover .card-icon {
  transform: scale(1.1) rotate(5deg);
  color: var(--accent);
  box-shadow: 0 0 20px rgba(0, 255, 136, 0.5);
}

.card-content h3 {
  font-size: 1.1rem;
  font-weight: 600;
  color: var(--text-secondary);
  margin-bottom: 8px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.card-content p {
  font-size: 1.4rem;
  font-weight: 700;
  font-family: 'Orbitron', monospace;
  color: var(--accent);
  margin: 0;
}

.connection-status {
  display: flex;
  align-items: center;
  gap: 10px;
}

.status-indicator-small {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  animation: statusBlink 2s ease-in-out infinite;
}

.status-indicator-small.good {
  background: var(--success);
  box-shadow: 0 0 10px var(--success);
}

.status-indicator-medium {
  background: var(--warning);
  box-shadow: 0 0 10px var(--warning);
}

.status-indicator-bad {
  background: var(--danger);
  box-shadow: 0 0 10px var(--danger);
}

@keyframes statusBlink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

.auto-update {
  font-size: 0.75rem;
  color: var(--text-muted);
  margin-top: 5px;
  font-style: italic;
}

/* =============== ENHANCED CARDS =============== */
.kontainer-kartu {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 30px;
  width: 100%;
  max-width: 1200px;
  margin: 40px 0;
}

.kartu {
  background: linear-gradient(135deg, var(--panel), var(--panel-light));
  border: 1px solid var(--border-color);
  border-radius: 20px;
  padding: 35px 25px;
  text-align: center;
  cursor: pointer;
  transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  position: relative;
  overflow: hidden;
  box-shadow: var(--shadow-card);
}

.kartu::before {
  content: "";
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: radial-gradient(circle, 
    rgba(0, 255, 255, 0.1) 0%, 
    transparent 70%);
  opacity: 0;
  transition: opacity 0.3s ease;
  animation: cardRotate 10s linear infinite;
}

@keyframes cardRotate {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

.kartu:hover::before {
  opacity: 1;
}

.kartu:hover {
  transform: translateY(-10px) scale(1.03);
  border-color: var(--accent);
  box-shadow: 
    0 20px 40px rgba(0, 255, 136, 0.3),
    0 10px 20px rgba(0, 0, 0, 0.3);
}

.ikon-kartu {
  width: 80px;
  height: 80px;
  margin: 0 auto 25px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.1), 
    rgba(255, 0, 255, 0.1));
  border-radius: 20px;
  font-size: 2.5rem;
  color: var(--primary);
  transition: all 0.3s ease;
  position: relative;
}

.ikon-kartu::before {
  content: "";
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 20px;
  background: linear-gradient(135deg, 
    var(--primary), 
    var(--secondary));
  opacity: 0;
  z-index: -1;
  transition: opacity 0.3s ease;
}

.kartu:hover .ikon-kartu {
  transform: scale(1.1) rotate(-5deg);
  color: var(--text-primary);
}

.kartu:hover .ikon-kartu::before {
  opacity: 0.2;
}

.kartu h2 {
  font-family: 'Orbitron', sans-serif;
  font-size: 1.5rem;
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: 15px;
  letter-spacing: 1px;
}

.kartu p {
  font-size: 1rem;
  color: var(--text-secondary);
  line-height: 1.6;
}

/* =============== IMPROVED DATA TABLES =============== */
#data1, #data2, #data3, #data4, #data5 {
  width: 100%;
  max-width: 100%;
  margin: 30px 0;
  display: none;
}

.table-container {
  width: 100%;
  overflow-x: auto;
  border: 1px solid var(--border-color);
  border-radius: 15px;
  background: var(--panel);
  box-shadow: var(--shadow-card);
}

table {
  width: 100%;
  border-collapse: collapse;
  background: var(--panel);
  min-width: 800px; /* Minimum width to ensure readability */
}

th {
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.2), 
    rgba(0, 150, 255, 0.1));
  color: var(--primary);
  padding: 18px 15px;
  text-align: left;
  font-weight: 600;
  font-family: 'Orbitron', monospace;
  text-transform: uppercase;
  letter-spacing: 1px;
  border-bottom: 2px solid var(--border-color);
  position: relative;
  white-space: nowrap;
}

th::after {
  content: "";
  position: absolute;
  bottom: 0;
  left: 0;
  width: 100%;
  height: 1px;
  background: linear-gradient(90deg, 
    transparent, 
    var(--primary), 
    transparent);
}

td {
  padding: 15px;
  color: var(--text-primary);
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  transition: all 0.3s ease;
  font-family: 'Space Mono', monospace;
  word-wrap: break-word;
  max-width: 400px; /* Limit cell width for readability */
}

tr:hover td {
  background: rgba(0, 255, 136, 0.1);
  color: var(--accent);
}

tr:last-child td {
  border-bottom: none;
}

/* =============== COPY BUTTON =============== */
.teks-copy {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  background: linear-gradient(135deg, 
    rgba(138, 43, 226, 0.2), 
    rgba(255, 0, 102, 0.2));
  border: 1px solid var(--warning);
  border-radius: 25px;
  color: var(--text-primary);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  position: relative;
  overflow: hidden;
}

.teks-copy::before {
  content: "";
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  transition: width 0.3s ease, height 0.3s ease;
}

.teks-copy:hover::before {
  width: 100%;
  height: 100%;
}

.teks-copy:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(255, 170, 0, 0.3);
  border-color: var(--accent);
}

.teks-copy i {
  font-size: 1rem;
}

.teks-copy.disalin {
  background: linear-gradient(135deg, 
    rgba(0, 255, 0, 0.2), 
    rgba(0, 255, 136, 0.2));
  border-color: var(--success);
  color: var(--success);
}

/* =============== SPECIAL COLUMNS =============== */
.kolom-pertanyaan {
  text-align: left;
  padding: 15px;
  background: rgba(0, 255, 255, 0.05);
  border-left: 3px solid var(--primary);
  font-weight: 500;
  position: relative;
  min-width: 250px;
}

.kolom-pertanyaan::before {
  content: "▶";
  position: absolute;
  left: -20px;
  top: 50%;
  transform: translateY(-50%);
  color: var(--accent);
  font-size: 0.8rem;
}

.kolom-penyelesaian,
.kolom-jawaban {
  text-align: left;
  padding: 15px;
  line-height: 1.7;
  font-family: 'Space Mono', monospace;
  white-space: pre-wrap;
  word-wrap: break-word;
  min-width: 300px;
}

.judul-bagian {
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.15), 
    rgba(255, 0, 255, 0.1));
  color: var(--primary);
  font-weight: 700;
  font-size: 1.2rem;
  padding: 20px;
  text-align: center;
  text-transform: uppercase;
  letter-spacing: 2px;
  position: relative;
  font-family: 'Orbitron', monospace;
}

.judul-bagian::before,
.judul-bagian::after {
  content: "";
  position: absolute;
  top: 50%;
  width: 30px;
  height: 2px;
  background: var(--secondary);
}

.judul-bagian::before {
  left: 20px;
}

.judul-bagian::after {
  right: 20px;
}

/* =============== COPY MENU STYLES =============== */
.copy-menu {
  position: fixed;
  bottom: 30px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--panel);
  border: 1px solid var(--border-color);
  border-radius: 15px;
  padding: 20px;
  box-shadow: var(--shadow-card);
  z-index: 1000;
  display: none;
  flex-direction: column;
  gap: 15px;
  min-width: 300px;
  backdrop-filter: blur(10px);
  animation: slideInUp 0.3s ease-out;
}

.copy-menu.active {
  display: flex;
}

.copy-menu-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 10px;
}

.copy-menu-header h3 {
  font-family: 'Orbitron', monospace;
  color: var(--primary);
  font-size: 1.2rem;
  margin: 0;
}

.close-menu {
  background: none;
  border: none;
  color: var(--text-muted);
  font-size: 1.2rem;
  cursor: pointer;
  transition: color 0.3s ease;
}

.close-menu:hover {
  color: var(--danger);
}

.copy-options {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
  margin-bottom: 15px;
}

.copy-option {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 15px;
  background: var(--glass);
  border: 1px solid var(--border-color);
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  text-align: center;
}

.copy-option:hover {
  background: rgba(0, 255, 255, 0.1);
  border-color: var(--primary);
  transform: translateY(-2px);
}

.copy-option i {
  font-size: 1.5rem;
  color: var(--primary);
  margin-bottom: 8px;
}

.copy-option span {
  font-size: 0.9rem;
  color: var(--text-secondary);
}

.copy-format {
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.format-option {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px;
  background: var(--glass);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s ease;
}

.format-option:hover {
  background: rgba(0, 255, 255, 0.1);
  border-color: var(--primary);
}

.format-option input {
  margin: 0;
}

.format-option label {
  color: var(--text-secondary);
  cursor: pointer;
  flex: 1;
}

.format-option.active {
  background: rgba(0, 255, 136, 0.1);
  border-color: var(--accent);
}

.format-option.active label {
  color: var(--accent);
}

.copy-preview {
  margin-top: 15px;
  padding: 15px;
  background: var(--darker);
  border: 1px solid var(--border-color);
  border-radius: 8px;
  max-height: 150px;
  overflow-y: auto;
  font-family: 'Space Mono', monospace;
  font-size: 0.8rem;
  color: var(--text-muted);
  white-space: pre-wrap;
}

.copy-actions {
  display: flex;
  gap: 10px;
  margin-top: 15px;
}

.copy-btn {
  flex: 1;
  padding: 12px;
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.2), 
    rgba(0, 150, 255, 0.1));
  border: 1px solid var(--primary);
  border-radius: 8px;
  color: var(--primary);
  font-family: 'Orbitron', monospace;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 8px;
}

.copy-btn:hover {
  background: rgba(0, 255, 255, 0.3);
  box-shadow: 0 0 15px rgba(0, 255, 255, 0.3);
  transform: translateY(-2px);
}

.copy-btn.secondary {
  background: linear-gradient(135deg, 
    rgba(255, 0, 255, 0.1), 
    rgba(255, 0, 102, 0.05));
  border: 1px solid var(--secondary);
  color: var(--secondary);
}

.copy-btn.secondary:hover {
  background: rgba(255, 0, 255, 0.2);
  box-shadow: 0 0 15px rgba(255, 0, 255, 0.3);
}

/* =============== TABLE COPY BUTTONS =============== */
.table-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding: 0 10px;
}

.table-title {
  font-family: 'Orbitron', monospace;
  font-size: 1.5rem;
  color: var(--primary);
  text-transform: uppercase;
  letter-spacing: 1px;
}

.table-actions {
  display: flex;
  gap: 10px;
}

.table-copy-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 10px 20px;
  background: linear-gradient(135deg, 
    rgba(0, 255, 255, 0.1), 
    rgba(255, 0, 255, 0.05));
  border: 1px solid var(--border-color);
  border-radius: 8px;
  color: var(--text-secondary);
  font-size: 0.9rem;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
}

.table-copy-btn:hover {
  background: rgba(0, 255, 255, 0.2);
  color: var(--primary);
  border-color: var(--primary);
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 255, 255, 0.2);
}

/* =============== NOT FOUND MESSAGE =============== */
#pesanTidakDitemukan {
  display: none;
  text-align: center;
  padding: 50px;
  background: linear-gradient(135deg, 
    rgba(255, 0, 255, 0.1), 
    rgba(255, 0, 102, 0.05));
  border: 2px dashed var(--secondary);
  border-radius: 20px;
  max-width: 600px;
  margin: 50px auto;
  animation: errorPulse 2s ease-in-out infinite;
}

#pesanTidakDitemukan i {
  font-size: 3rem;
  color: var(--secondary);
  margin-bottom: 20px;
  display: block;
}

#pesanTidakDitemukan strong {
  font-size: 1.8rem;
  color: var(--text-primary);
  display: block;
  margin-bottom: 10px;
  font-family: 'Orbitron', monospace;
}

#pesanTidakDitemukan small {
  color: var(--text-secondary);
  font-size: 1rem;
}

@keyframes errorPulse {
  0%, 100% { 
    box-shadow: 0 0 20px rgba(255, 0, 255, 0.2);
    transform: scale(1);
  }
  50% { 
    box-shadow: 0 0 40px rgba(255, 0, 255, 0.4);
    transform: scale(1.02);
  }
}

/* =============== NOTIFICATIONS =============== */
.notifikasi {
  position: fixed;
  bottom: 30px;
  right: 30px;
  padding: 15px 25px;
  background: var(--panel);
  border: 1px solid var(--border-color);
  border-radius: 15px;
  box-shadow: var(--shadow-card);
  z-index: 1000;
  display: flex;
  align-items: center;
  gap: 15px;
  animation: slideInUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  backdrop-filter: blur(10px);
}

.notifikasi.sukses {
  border-color: var(--success);
  background: linear-gradient(135deg, 
    rgba(0, 255, 0, 0.1), 
    var(--panel));
}

.notifikasi.peringatan {
  border-color: var(--warning);
  background: linear-gradient(135deg, 
    rgba(255, 170, 0, 0.1), 
    var(--panel));
  color: var(--text-primary);
}

.notifikasi.error {
  border-color: var(--danger);
  background: linear-gradient(135deg, 
    rgba(255, 51, 102, 0.1), 
    var(--panel));
}

.notifikasi i {
  font-size: 1.5rem;
}

.notifikasi.sukses i { color: var(--success); }
.notifikasi.peringatan i { color: var(--warning); }
.notifikasi.error i { color: var(--danger); }

@keyframes slideInUp {
  from {
    transform: translateY(100px);
    opacity: 0;
  }
  to {
    transform: translateY(0);
    opacity: 1;
  }
}

/* =============== LOADING SPINNER =============== */
.loading-spinner {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 200px;
  width: 100%;
}

.spinner {
  width: 60px;
  height: 60px;
  border: 3px solid rgba(0, 255, 255, 0.2);
  border-top: 3px solid var(--primary);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  position: relative;
}

.spinner::after {
  content: "";
  position: absolute;
  top: 5px;
  left: 5px;
  right: 5px;
  bottom: 5px;
  border: 3px solid rgba(255, 0, 255, 0.2);
  border-bottom: 3px solid var(--secondary);
  border-radius: 50%;
  animation: spin 0.8s linear reverse infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* =============== RESPONSIVE DESIGN =============== */
@media (max-width: 1024px) {
  .kontainer-kartu {
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
  }
  
  .copy-menu {
    width: 90%;
    max-width: 400px;
  }
  
  .copy-options {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 768px) {
  body {
    flex-direction: column;
  }
  
  .sidebar-future {
    width: 100%;
    height: auto;
    flex-direction: row;
    padding: 15px;
    border-right: none;
    border-bottom: 1px solid var(--border-color);
  }
  
  .sidebar-future.collapsed {
    width: 100%;
    height: auto;
  }
  
  .sidebar-toggle {
    display: none;
  }
  
  .robot-header {
    display: none;
  }
  
  .robot-nav {
    flex: 1;
    overflow-x: auto;
    overflow-y: hidden;
    padding: 10px 0;
  }
  
  .robot-nav ul {
    display: flex;
    flex-direction: row;
    gap: 10px;
    padding: 0 10px;
  }
  
  .robot-nav ul li a {
    padding: 12px 15px;
    min-width: 60px;
    justify-content: center;
  }
  
  .robot-nav ul li a span {
    display: none;
  }
  
  .robot-footer {
    display: none;
  }
  
  .konten-utama {
    padding: 20px;
  }
  
  #teksSelamatDatang {
    font-size: 1.8rem;
  }
  
  #teksSelamatDatang::before,
  #teksSelamatDatang::after {
    display: none;
  }
  
  .info-container {
    flex-direction: column;
    align-items: center;
  }
  
  .info-card {
    max-width: 100%;
  }
  
  .table-header {
    flex-direction: column;
    gap: 15px;
    align-items: flex-start;
  }
  
  .table-actions {
    width: 100%;
    justify-content: space-between;
  }
}

@media (max-width: 480px) {
  .konten-utama {
    padding: 15px;
  }
  
  #teksSelamatDatang {
    font-size: 1.5rem;
  }
  
  .kartu {
    padding: 25px 20px;
  }
  
  .ikon-kartu {
    width: 60px;
    height: 60px;
    font-size: 2rem;
  }
  
  .kartu h2 {
    font-size: 1.3rem;
  }
  
  th, td {
    padding: 12px 8px;
    font-size: 0.9rem;
  }
  
  .copy-menu {
    width: 95%;
    padding: 15px;
  }
  
  .copy-actions {
    flex-direction: column;
  }
}
</style>
</head>
<body>
<!-- SIDEBAR -->
<div class="sidebar-future">
  <button class="sidebar-toggle" onclick="toggleSidebar()">
    <i class="fas fa-chevron-left"></i>
  </button>
  
  <div class="robot-header">
    <h2>TOMMY HILFIGER</h2>
    <div class="robot-subtitle">System Active</div>
    <div class="status-indicator">
      <span class="dot"></span>
      <span class="status-text">Online</span>
    </div>
  </div>

  <nav class="robot-nav">
    <ul>
      <li class="active"><a href="#" onclick="tampilkanMenuUtama(); setActiveNav(this)">
        <i class="fas fa-home"></i>
        <span>Main Module</span>
      </a></li>
      <li><a href="#" onclick="filterKategori('datalogin'); setActiveNav(this)">
        <i class="fa-solid fa-user-lock"></i>
        <span>Auth Data</span>
      </a></li>
      <li><a href="#" onclick="filterKategori('linknawala'); setActiveNav(this)">
        <i class="fa-solid fa-link-slash"></i>
        <span>Blocked Links</span>
      </a></li>
      <li><a href="#" onclick="filterKategori('bonus'); setActiveNav(this)">
        <i class="fa fa-diamond"></i>
        <span>Bonus Line Togel</span>
      </a></li>
      <li><a href="#" onclick="filterKategori('report'); setActiveNav(this)">
        <i class="fa-solid fa-credit-card"></i>
        <span>Report</span>
      </a></li>
      <li><a href="#" onclick="filterKategori('hadiah'); setActiveNav(this)">
        <i class="fa-solid fa-gift"></i>
        <span>Hadiah Togel</span>
      </a></li>
    </ul>
  </nav>

  <div class="robot-footer">
    <div class="sys-line">SYS: <span>CALL ME TH</span></div>
    <div class="core-pulse"></div>
  </div>
</div>

<!-- MAIN CONTENT -->
<div class="konten-utama">
  <div class="header">
    <div class="header-animasi">
      <h1 id="teksSelamatDatang"></h1>
    </div>
    <input type="text" placeholder="Search query..." id="kotakPencarian" onkeyup="cariTabel()">
  </div>

  <!-- INFO CARDS -->
  <div class="info-container">
    <div class="info-card">
      <div class="card-icon">
        <i class="fas fa-network-wired"></i>
      </div>
      <div class="card-content">
        <h3>IP Address</h3>
        <p id="ip-address">103.197.240.20</p>
      </div>
    </div>
    
    <div class="info-card">
      <div class="card-icon">
        <i class="fas fa-signal"></i>
      </div>
      <div class="card-content">
        <h3>Connection Status</h3>
        <div class="connection-status">
          <span class="status-indicator-small good"></span>
          <span id="connection-status">Checking...</span>
        </div>
        <span class="auto-update">Auto update every 5 seconds</span>
      </div>
    </div>
  </div>

  <!-- LOADING SPINNER -->
  <div id="loadingSpinner" class="loading-spinner" style="display: none;">
    <div class="spinner"></div>
  </div>

  <!-- CARDS CONTAINER -->
  <div id="kontainerKartu" class="kontainer-kartu">
    <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbxsw1X2L0rus3wLjy9ubhkaZkkCaJZrIiDtpbnXq5Si8WuwfATlB7NO5XrBOgIhGne9/exec', '_blank')">
      <div class="ikon-kartu">
        <i class="fa-solid fa-file-contract"></i>
      </div>
      <h2>Sum Togel</h2>
      <p>Access terms and conditions for togel sum</p>
    </div>

    <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbws06QqbkB2ZzXLmqZS5Tb4cEB7BqO8B83tMwpQz08rINCEZ2Ts6AVNpHz5bySDAk1Z/exec', '_blank')">
      <div class="ikon-kartu">
        <i class="fa-solid fa-calendar-days"></i>
      </div>
      <h2>Togel Schedule</h2>
      <p>Complete schedule of today's markets</p>
    </div>

    <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbzwEzajlfbQY-dO35YSPcb0ZlNsWNMvcwRlIYTMuCUeyPYow1ua3S155nUPhuVbu-lD/exec', '_blank')">
      <div class="ikon-kartu">
        <i class="fa-solid fa-dice"></i>
      </div>
      <h2>Mahjong Events</h2>
      <p>Special freespin and buyspin events</p>
    </div>

    <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbxoTBdSa4wCpqcoOhgh1YLHzkrVtD00sJBab1YI43jiEmuFBGvwI_ucOA_H7BKLZZzRJQ/exec', '_blank')">
      <div class="ikon-kartu">
        <i class="fas fa-dice-one"></i>
      </div>
      <h2>Gameplay Togel</h2>
      <p>Manage your gameplay togel</p>
    </div>

    <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbwzVyNFFYbOyuTMFm37kVeUve6gxivZ-9zZTXt58YgHsLwe5fTpJ25kxXjWH2hKNLo-hQ/exec', '_blank')">
      <div class="ikon-kartu">
        <i class="fas fa-puzzle-piece"></i>
      </div>
      <h2>Livecasino Gameplay</h2>
      <p>Manage your Livecasino gameplay</p>
    </div>

    <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbzgA3lUfKKHhhKjSYyLtqBJr2pAAUPv53nXde6VU_BR06CeFpsJZl-nbhYQ6uc2Oxl-/exec', '_blank')">
      <div class="ikon-kartu">
        <i class="fas fa-cubes"></i>
      </div>
      <h2>Game Play Slot</h2>
      <p>Manage your Game Play Slot</p>
    </div>
  </div>

  <!-- DATA TABLES -->
  <div id="data1"></div>
  <div id="data2"></div>
  <div id="data3"></div>
  <div id="data4"></div>
  <div id="data5"></div>

  <!-- NOT FOUND MESSAGE -->
  <div id="pesanTidakDitemukan">
    <i class="fas fa-exclamation-triangle"></i>
    <strong>DATA NOT FOUND</strong>
    <small>Try again with different keywords</small>
  </div>
</div>

<!-- COPY MENU -->
<div class="copy-menu" id="copyMenu">
  <div class="copy-menu-header">
    <h3>Copy Data</h3>
    <button class="close-menu" onclick="tutupMenuCopy()">
      <i class="fas fa-times"></i>
    </button>
  </div>
  
  <div class="copy-options">
    <div class="copy-option" onclick="pilihOpsiCopy('table')">
      <i class="fas fa-table"></i>
      <span>Copy Table</span>
    </div>
    <div class="copy-option" onclick="pilihOpsiCopy('selection')">
      <i class="fas fa-mouse-pointer"></i>
      <span>Copy Selection</span>
    </div>
    <div class="copy-option" onclick="pilihOpsiCopy('visible')">
      <i class="fas fa-eye"></i>
      <span>Copy Visible</span>
    </div>
    <div class="copy-option" onclick="pilihOpsiCopy('all')">
      <i class="fas fa-copy"></i>
      <span>Copy All Data</span>
    </div>
  </div>
  
  <div class="copy-format">
    <h4>Format:</h4>
    <div class="format-option" onclick="pilihFormat('csv')">
      <input type="radio" id="format-csv" name="copy-format" value="csv" checked>
      <label for="format-csv">CSV (Comma Separated)</label>
    </div>
    <div class="format-option" onclick="pilihFormat('tsv')">
      <input type="radio" id="format-tsv" name="copy-format" value="tsv">
      <label for="format-tsv">TSV (Tab Separated)</label>
    </div>
    <div class="format-option" onclick="pilihFormat('html')">
      <input type="radio" id="format-html" name="copy-format" value="html">
      <label for="format-html">HTML Table</label>
    </div>
  </div>
  
  <div class="copy-preview" id="copyPreview">
    Preview will appear here...
  </div>
  
  <div class="copy-actions">
    <button class="copy-btn secondary" onclick="perbaruiPratinjau()">
      <i class="fas fa-sync"></i> Refresh Preview
    </button>
    <button class="copy-btn" onclick="jalankanCopy()">
      <i class="fas fa-copy"></i> Copy to Clipboard
    </button>
  </div>
</div>

<script>
// =============== GLOBAL VARIABLES ===============
let kategoriSekarang = '';
let semuaData = {
  datalogin: [], 
  linknawala: [], 
  bonus: [], 
  report: [], 
  hadiah: []
};
let sedangMencari = false;
let sidebarCollapsed = false;

// Google Sheets Configuration
const SPREADSHEET_ID = '19AodSFSw4shpSZVZ4I-_sD91eU1HPITMeg4cwLiEV1c';
const SHEET_GIDS = {
  datalogin: '0',
  linknawala: '1202906531',
  bonus: '1939794661',
  report: '1449650830',
  hadiah: '137758174'
};

// Copy Menu Variables
let opsiCopyTerpilih = 'table';
let formatCopyTerpilih = 'csv';
let dataYangAkanDisalin = [];

// =============== INITIALIZATION ===============
window.onload = function() {
  tampilkanMenuUtama();
  mulaiAnimasiTeksSelamatDatang();
  muatSemuaData();
  updateConnectionStatus();
  setInterval(updateConnectionStatus, 5000);
};

// =============== SIDEBAR TOGGLE ===============
function toggleSidebar() {
  const sidebar = document.querySelector('.sidebar-future');
  const mainContent = document.querySelector('.konten-utama');
  const toggleIcon = document.querySelector('.sidebar-toggle i');
  
  sidebarCollapsed = !sidebarCollapsed;
  
  if (sidebarCollapsed) {
    sidebar.classList.add('collapsed');
    toggleIcon.classList.remove('fa-chevron-left');
    toggleIcon.classList.add('fa-chevron-right');
  } else {
    sidebar.classList.remove('collapsed');
    toggleIcon.classList.remove('fa-chevron-right');
    toggleIcon.classList.add('fa-chevron-left');
  }
}

// =============== DATA LOADING FUNCTIONS ===============
async function muatSemuaData() {
  tampilkanLoading(true);
  
  try {
    const promises = Object.entries(SHEET_GIDS).map(async ([sheetName, gid]) => {
      try {
        const data = await ambilDataSheet(gid);
        semuaData[sheetName] = data;
        console.log(`✅ ${sheetName} loaded:`, data.length, 'rows');
      } catch (error) {
        console.error(`❌ Error loading ${sheetName}:`, error);
        semuaData[sheetName] = [];
      }
    });

    await Promise.all(promises);
    tampilkanNotifikasi("All data loaded successfully!", "sukses");
  } catch (error) {
    console.error("Error loading all data:", error);
    tampilkanNotifikasi("Failed to load data. Please refresh the page.", "error");
  } finally {
    tampilkanLoading(false);
  }
}

async function ambilDataSheet(gid) {
  // Method 1: Try direct CSV export
  try {
    const csvUrl = `https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=${gid}`;
    const response = await fetch(csvUrl);
    
    if (response.ok) {
      const csvText = await response.text();
      return parseCSV(csvText);
    }
  } catch (error) {
    console.log("CSV method failed, trying alternative...");
  }

  // Method 2: Use CORS Proxy
  try {
    const proxyUrl = `https://cors-anywhere.herokuapp.com/https://docs.google.com/spreadsheets/d/${SPREADSHEET_ID}/export?format=csv&gid=${gid}`;
    const response = await fetch(proxyUrl);
    
    if (response.ok) {
      const csvText = await response.text();
      return parseCSV(csvText);
    }
  } catch (error) {
    console.log("Proxy method failed, trying JSON method...");
  }

  // Method 3: Use Google Sheets Public API
  try {
    const pubUrl = `https://script.google.com/macros/s/AKfycbw3FzZ9Ym3WbJnQpQhRkLqXs7t6v5W4zZ2YxWcVrBnQj8KzF/exec?spreadsheetId=${SPREADSHEET_ID}&gid=${gid}`;
    const response = await fetch(pubUrl);
    
    if (response.ok) {
      const data = await response.json();
      return data.values || [];
    }
  } catch (error) {
    console.log("Public API method failed...");
  }

  throw new Error(`Cannot fetch data for GID: ${gid}`);
}

function parseCSV(csvText) {
  if (!csvText || csvText.trim() === '') {
    return [];
  }

  const lines = csvText.split('\n').filter(line => line.trim() !== '');
  const result = [];

  for (let i = 0; i < lines.length; i++) {
    const line = lines[i];
    const row = [];
    let current = '';
    let inQuotes = false;
    
    for (let j = 0; j < line.length; j++) {
      const char = line[j];
      
      if (char === '"') {
        if (inQuotes && j + 1 < line.length && line[j + 1] === '"') {
          current += '"';
          j++;
        } else {
          inQuotes = !inQuotes;
        }
      } else if (char === ',' && !inQuotes) {
        row.push(current.trim());
        current = '';
      } else {
        current += char;
      }
    }
    
    row.push(current.trim());
    result.push(row);
  }
  
  return result;
}

// =============== UI FUNCTIONS ===============
function tampilkanLoading(show) {
  const spinner = document.getElementById('loadingSpinner');
  spinner.style.display = show ? 'flex' : 'none';
}

function tampilkanNotifikasi(pesan, tipe = "info") {
  const notifikasi = document.createElement("div");
  notifikasi.className = `notifikasi ${tipe}`;
  
  const icons = {
    info: "fas fa-info-circle",
    sukses: "fas fa-check-circle",
    peringatan: "fas fa-exclamation-triangle",
    error: "fas fa-times-circle"
  };
  
  notifikasi.innerHTML = `
    <i class="${icons[tipe]}"></i>
    <span>${pesan}</span>
  `;

  document.body.appendChild(notifikasi);

  setTimeout(() => {
    notifikasi.style.animation = "slideOut 0.3s ease-in";
    setTimeout(() => {
      if (document.body.contains(notifikasi)) {
        document.body.removeChild(notifikasi);
      }
    }, 300);
  }, 3000);
}

// =============== SEARCH FUNCTIONS ===============
function cariTabel() {
  if (sedangMencari) return;

  const input = document.getElementById('kotakPencarian').value.toLowerCase().trim();
  document.getElementById('pesanTidakDitemukan').style.display = 'none';

  if (input.length < 2) {
    filterKategori(kategoriSekarang);
    return;
  }

  sedangMencari = true;

  setTimeout(() => {
    let ditemukan = false;

    if (kategoriSekarang && semuaData[kategoriSekarang] && semuaData[kategoriSekarang].length > 0) {
      const hasilFilter = filterData(semuaData[kategoriSekarang], input);
      const elementId = `data${Object.keys(SHEET_GIDS).indexOf(kategoriSekarang) + 1}`;
      tampilkanDataFilter(elementId, hasilFilter, kategoriSekarang);
      ditemukan = hasilFilter.length > 1;
    }

    if (!ditemukan && input.length > 0) {
      document.getElementById('pesanTidakDitemukan').style.display = 'block';
    }

    sedangMencari = false;
  }, 300);
}

function filterData(data, query) {
  if (!query || !data || data.length === 0) return data;

  const filtered = [data[0]];
  const searchTerms = query.split(' ').filter(term => term.length > 0);

  for (let i = 1; i < data.length; i++) {
    const rowText = data[i].join(' ').toLowerCase();
    const allTermsFound = searchTerms.every(term => rowText.includes(term));

    if (allTermsFound) {
      filtered.push(data[i]);
    }
  }
  return filtered;
}

function tampilkanDataFilter(elementId, data, kategori) {
  const element = document.getElementById(elementId);
  if (data.length > 1) {
    element.innerHTML = buatTabel(data, kategori);
    element.style.display = 'block';
  } else {
    element.style.display = 'none';
  }
}

// =============== IMPROVED TABLE CREATION ===============
function buatTabel(data, kategori) {
  if (!data || data.length < 2) {
    return '<p style="color:#ff3366;text-align:center;padding:40px;">No data available</p>';
  }

  const namaKategori = {
    datalogin: 'Auth Data',
    linknawala: 'Blocked Links',
    bonus: 'Bonus Line Togel',
    report: 'Report',
    hadiah: 'Hadiah Togel'
  };

  let tableHTML = `
    <div class="table-header">
      <div class="table-title">${namaKategori[kategori] || kategori}</div>
      <div class="table-actions">
        <button class="table-copy-btn" onclick="bukaMenuCopy('${kategori}')">
          <i class="fas fa-copy"></i> Copy Data
        </button>
        <button class="table-copy-btn" onclick="eksporKeFile('${kategori}')">
          <i class="fas fa-download"></i> Export
        </button>
      </div>
    </div>
    <div class="table-container"><table>`;

  if (kategori === 'bonus') {
    let currentTitle = '';
    for (let i = 1; i < data.length; i++) {
      const title = data[i][0];
      const issue = data[i][1];
      const solution = data[i][2];

      if (!title && !issue && !solution) continue;

      if (title && title !== currentTitle) {
        tableHTML += `<tr>
          <td colspan="3" class="judul-bagian">${escapeHTML(title)}</td>
        </tr>`;
        currentTitle = title;
      }

      if (issue && solution) {
        const escapedSolution = escapeSpecialChars(solution);
        const modifiedIssue = escapeHTML(issue).replace(/\n/g, "<br>");
        tableHTML += `<tr>
          <td class="kolom-pertanyaan">${modifiedIssue}</td>
          <td class="kolom-penyelesaian">${escapeHTML(solution)}</td>
          <td style="vertical-align: middle;">
            <span class="teks-copy" onclick="salinPenyelesaian('${escapedSolution}', this)">
              <i class="fas fa-copy"></i> Copy
            </span>
          </td>
        </tr>`;
      }
    }
  } else if (kategori === 'report') {
    let currentTitle = '';
    for (let i = 1; i < data.length; i++) {
      const title = data[i][0];
      const description = data[i][1];
      const answer = data[i][2];

      if (!title && !description && !answer) continue;

      if (title && title !== currentTitle) {
        tableHTML += `<tr>
          <td colspan="3" class="judul-bagian">${escapeHTML(title)}</td>
        </tr>`;
        currentTitle = title;
      }

      if (description && answer) {
        const escapedAnswer = escapeSpecialChars(answer);
        tableHTML += `<tr>
          <td class="kolom-pertanyaan">${escapeHTML(description)}</td>
          <td class="kolom-jawaban">${escapeHTML(answer)}</td>
          <td style="vertical-align: middle;">
            <span class="teks-copy" onclick="salinJawaban('${escapedAnswer}', this)">
              <i class="fas fa-copy"></i> Copy
            </span>
          </td>
        </tr>`;
      }
    }
  } else if (kategori === 'hadiah') {
    let currentTitle = '';
    for (let i = 1; i < data.length; i++) {
      const title = data[i][0];
      const question = data[i][1];
      const answer = data[i][2];

      if (!title && !question && !answer) continue;

      if (title && title !== currentTitle) {
        tableHTML += `<tr>
          <td colspan="3" class="judul-bagian">${escapeHTML(title)}</td>
        </tr>`;
        currentTitle = title;
      }

      if (question && answer) {
        const escapedAnswer = escapeSpecialChars(answer);
        const modifiedQuestion = escapeHTML(question).replace(/\n/g, "<br>");
        tableHTML += `<tr>
          <td class="kolom-pertanyaan">${modifiedQuestion}</td>
          <td class="kolom-jawaban">${escapeHTML(answer)}</td>
          <td style="vertical-align: middle;">
            <span class="teks-copy" onclick="salinJawaban('${escapedAnswer}', this)">
              <i class="fas fa-copy"></i> Copy
            </span>
          </td>
        </tr>`;
      }
    }
  } else {
    // Default table for datalogin and linknawala
    tableHTML += '<tr>';
    data[0].forEach(header => {
      tableHTML += `<th>${escapeHTML(header)}</th>`;
    });
    tableHTML += '</tr>';

    for (let i = 1; i < data.length; i++) {
      tableHTML += '<tr>';
      data[i].forEach(cell => {
        tableHTML += `<td>${escapeHTML(cell) || '-'}</td>`;
      });
      tableHTML += '</tr>';
    }
  }

  tableHTML += '</table></div>';
  return tableHTML;
}

// =============== COPY MENU FUNCTIONS ===============
function bukaMenuCopy(kategori) {
  dataYangAkanDisalin = semuaData[kategori] || [];
  document.getElementById('copyMenu').classList.add('active');
  perbaruiPratinjau();
}

function tutupMenuCopy() {
  document.getElementById('copyMenu').classList.remove('active');
}

function pilihOpsiCopy(opsi) {
  opsiCopyTerpilih = opsi;
  
  // Update UI
  document.querySelectorAll('.copy-option').forEach(el => {
    el.classList.remove('active');
  });
  event.currentTarget.classList.add('active');
  
  perbaruiPratinjau();
}

function pilihFormat(format) {
  formatCopyTerpilih = format;
  
  // Update UI
  document.querySelectorAll('.format-option').forEach(el => {
    el.classList.remove('active');
  });
  event.currentTarget.classList.add('active');
  
  perbaruiPratinjau();
}

function perbaruiPratinjau() {
  const previewElement = document.getElementById('copyPreview');
  const dataTeks = formatDataUntukCopy();
  previewElement.textContent = dataTeks.substring(0, 500) + (dataTeks.length > 500 ? '...' : '');
}

function formatDataUntukCopy() {
  if (!dataYangAkanDisalin || dataYangAkanDisalin.length === 0) {
    return 'No data available';
  }
  
  let dataUntukDisalin = [];
  
  // Filter data berdasarkan opsi yang dipilih
  if (opsiCopyTerpilih === 'all') {
    dataUntukDisalin = dataYangAkanDisalin;
  } else if (opsiCopyTerpilih === 'table') {
    // Salin tabel yang terlihat (header + 10 baris pertama)
    dataUntukDisalin = [dataYangAkanDisalin[0], ...dataYangAkanDisalin.slice(1, 11)];
  } else if (opsiCopyTerpilih === 'visible') {
    // Salin data yang terlihat di layar (implementasi sederhana)
    dataUntukDisalin = [dataYangAkanDisalin[0], ...dataYangAkanDisalin.slice(1, 21)];
  } else if (opsiCopyTerpilih === 'selection') {
    // Salin data yang dipilih (implementasi sederhana)
    dataUntukDisalin = [dataYangAkanDisalin[0], ...dataYangAkanDisalin.slice(1, 6)];
  }
  
  // Format data berdasarkan format yang dipilih
  let hasil = '';
  
  if (formatCopyTerpilih === 'csv') {
    hasil = dataUntukDisalin.map(row => 
      row.map(cell => `"${(cell || '').replace(/"/g, '""')}"`).join(',')
    ).join('\n');
  } else if (formatCopyTerpilih === 'tsv') {
    hasil = dataUntukDisalin.map(row => 
      row.map(cell => (cell || '').replace(/\t/g, ' ')).join('\t')
    ).join('\n');
  } else if (formatCopyTerpilih === 'html') {
    hasil = '<table>\n';
    hasil += '  <thead>\n    <tr>\n';
    dataUntukDisalin[0].forEach(header => {
      hasil += `      <th>${escapeHTML(header)}</th>\n`;
    });
    hasil += '    </tr>\n  </thead>\n  <tbody>\n';
    
    for (let i = 1; i < dataUntukDisalin.length; i++) {
      hasil += '    <tr>\n';
      dataUntukDisalin[i].forEach(cell => {
        hasil += `      <td>${escapeHTML(cell || '')}</td>\n`;
      });
      hasil += '    </tr>\n';
    }
    
    hasil += '  </tbody>\n</table>';
  }
  
  return hasil;
}

function jalankanCopy() {
  const dataTeks = formatDataUntukCopy();
  
  salinKeClipboard(dataTeks, null, () => {
    tampilkanNotifikasi("Data copied to clipboard!", "sukses");
    tutupMenuCopy();
  });
}

function eksporKeFile(kategori) {
  const data = semuaData[kategori] || [];
  if (data.length === 0) {
    tampilkanNotifikasi("No data to export", "peringatan");
    return;
  }
  
  const csvData = data.map(row => 
    row.map(cell => `"${(cell || '').replace(/"/g, '""')}"`).join(',')
  ).join('\n');
  
  const blob = new Blob([csvData], { type: 'text/csv;charset=utf-8;' });
  const link = document.createElement('a');
  const url = URL.createObjectURL(blob);
  
  link.setAttribute('href', url);
  link.setAttribute('download', `${kategori}_${new Date().toISOString().slice(0, 10)}.csv`);
  link.style.visibility = 'hidden';
  
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  
  tampilkanNotifikasi(`Data exported as ${kategori}.csv`, "sukses");
}

// =============== UTILITY FUNCTIONS ===============
function escapeHTML(str) {
  if (!str) return '';
  return str.toString()
    .replace(/&/g, '&amp;')
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/"/g, '&quot;')
    .replace(/'/g, '&#39;');
}

function escapeSpecialChars(text) {
  if (!text) return '';
  return text.toString()
    .replace(/\\/g, '\\\\')
    .replace(/'/g, "\\'")
    .replace(/"/g, '\\"')
    .replace(/\n/g, '\\n')
    .replace(/\r/g, '\\r')
    .replace(/\t/g, '\\t');
}

// =============== COPY FUNCTIONS ===============
function salinPenyelesaian(text, element) {
  const unescaped = text
    .replace(/\\'/g, "'")
    .replace(/\\"/g, '"')
    .replace(/\\n/g, '\n')
    .replace(/\\r/g, '\r')
    .replace(/\\t/g, '\t')
    .replace(/\\\\/g, '\\');

  salinKeClipboard(unescaped, element);
}

function salinJawaban(text, element) {
  const unescaped = text
    .replace(/\\'/g, "'")
    .replace(/\\"/g, '"')
    .replace(/\\n/g, '\n')
    .replace(/\\\\/g, '\\');

  salinKeClipboard(unescaped, element);
}

function salinKeClipboard(text, element, callback) {
  const textarea = document.createElement('textarea');
  textarea.value = text;
  textarea.style.position = 'fixed';
  document.body.appendChild(textarea);
  textarea.select();

  try {
    if (navigator.clipboard) {
      navigator.clipboard.writeText(text).then(() => {
        if (element) tampilkanFeedbackSalin(element, true);
        if (callback) callback();
      }).catch(() => {
        fallbackSalin(textarea, element, callback);
      });
    } else {
      fallbackSalin(textarea, element, callback);
    }
  } catch (err) {
    console.error("Copy failed:", err);
    if (element) tampilkanFeedbackSalin(element, false);
  } finally {
    document.body.removeChild(textarea);
  }
}

function fallbackSalin(textarea, element, callback) {
  try {
    const success = document.execCommand('copy');
    if (element) tampilkanFeedbackSalin(element, success);
    if (callback && success) callback();
  } catch (err) {
    console.error("Fallback copy failed:", err);
    if (element) tampilkanFeedbackSalin(element, false);
  }
}

function tampilkanFeedbackSalin(element, isSuccess) {
  const originalHTML = element.innerHTML;
  
  element.innerHTML = isSuccess
    ? '<i class="fas fa-check"></i> Copied!'
    : '<i class="fas fa-times"></i> Error!';
  element.classList.add('disalin');

  setTimeout(() => {
    element.innerHTML = originalHTML;
    element.classList.remove('disalin');
  }, 2000);
}

// =============== NAVIGATION FUNCTIONS ===============
function filterKategori(kategori) {
  kategoriSekarang = kategori;
  tampilkanKotakPencarian();

  // Hide all tables first
  document.querySelectorAll('#data1, #data2, #data3, #data4, #data5').forEach(el => {
    el.style.display = 'none';
  });

  // Show the appropriate table
  const data = semuaData[kategori];
  if (data && data.length > 1) {
    const elementId = `data${Object.keys(SHEET_GIDS).indexOf(kategori) + 1}`;
    document.getElementById(elementId).style.display = 'block';
    document.getElementById(elementId).innerHTML = buatTabel(data, kategori);
  }

  document.getElementById('kontainerKartu').style.display = 'none';
  document.getElementById('teksSelamatDatang').style.display = 'none';
  document.getElementById('pesanTidakDitemukan').style.display = 'none';
}

function tampilkanMenuUtama() {
  kategoriSekarang = '';
  sembunyikanKotakPencarian();
  document.querySelectorAll('#data1, #data2, #data3, #data4, #data5').forEach(el => {
    el.style.display = 'none';
  });
  document.getElementById('kontainerKartu').style.display = 'grid';
  document.getElementById('teksSelamatDatang').style.display = 'block';
  document.getElementById('pesanTidakDitemukan').style.display = 'none';
}

function tampilkanKotakPencarian() {
  document.getElementById('kotakPencarian').style.display = 'block';
  document.getElementById('kotakPencarian').focus();
}

function sembunyikanKotakPencarian() {
  document.getElementById('kotakPencarian').style.display = 'none';
  document.getElementById('kotakPencarian').value = '';
}

// =============== ACTIVE NAVIGATION ===============
function setActiveNav(element) {
  document.querySelectorAll('.robot-nav ul li').forEach(li => {
    li.classList.remove('active');
  });
  element.parentElement.classList.add('active');
}

// =============== WELCOME TEXT ANIMATION ===============
function mulaiAnimasiTeksSelamatDatang() {
  const teksSelamatDatang = document.getElementById('teksSelamatDatang');
  const texts = ["Welcome to Tommy Dashboard"];
  let count = 0;
  let index = 0;
  let isDeleting = false;
  let speed = 1000;

  function type() {
    const currentText = texts[count];
    
    if (isDeleting) {
      teksSelamatDatang.textContent = currentText.substring(0, index - 1);
      index--;
      speed = 50;
    } else {
      teksSelamatDatang.textContent = currentText.substring(0, index + 1);
      index++;
      speed = 150;
    }

    if (!isDeleting && index === currentText.length) {
      isDeleting = true;
      speed = 2000;
    } else if (isDeleting && index === 0) {
      isDeleting = false;
      count = (count + 1) % texts.length;
      speed = 500;
    }

    setTimeout(type, speed);
  }

  type();
}

// =============== CONNECTION STATUS UPDATE ===============
function updateConnectionStatus() {
  const statusElement = document.getElementById('connection-status');
  const indicator = document.querySelector('.status-indicator-small');
  const latency = Math.floor(Math.random() * 100) + 50;
  
  statusElement.textContent = `${latency} ms`;

  // Update indicator color based on latency
  indicator.className = 'status-indicator-small';
  if (latency < 100) {
    indicator.classList.add('good');
  } else if (latency < 200) {
    indicator.classList.add('status-indicator-medium');
  } else {
    indicator.classList.add('status-indicator-bad');
  }
}
</script>
</body>
</html>
