
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ðŸ¤– TOMMY æ²ˆ - Tanpa Sidebar</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root {
      --primary: #66ffff;
      --secondary: #ff33ff;
      --accent: #33ff33;
      --dark: #0a0a0a;
      --darker: #000000;
      --panel: #111115;
      --border-color: #444466;
      --text-primary: #ffffff;
      --text-secondary: #c0c0ff;
      --scanline-color: rgba(100, 255, 255, 0.1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Orbitron', 'Courier New', monospace;
      background: url('https://i.postimg.cc/HsSGyLHH/optimus-prime-badass.gif') center fixed;
      background-size: cover + media query;
      color: var(--text-primary);
      display: flex;
      min-height: 100vh;
      overflow-x: hidden;
      position: relative;
    }

    body::before {
      content: "";
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background:
        radial-gradient(circle at 10% 20%, rgba(0, 100, 100, 0.1) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(100, 0, 100, 0.1) 0%, transparent 20%);
      pointer-events: none;
      z-index: -1;
    }

    .konten-utama {
      flex: 1;
      padding: 30px;
      display: flex;
      flex-direction: column;
      align-items: center;
      position: relative;
      max-width: 1400px;
      margin: 0 auto;
      width: 100%;
    }

    .konten-utama::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background:
        repeating-linear-gradient(
          0deg,
          rgba(100, 100, 150, 0.03),
          rgba(100, 100, 150, 0.03) 1px,
          transparent 1px,
          transparent 3px
        );
      pointer-events: none;
      animation: scan-content 10s linear infinite;
    }

    .header {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      margin-bottom: 30px;
      position: relative;
    }

    .header-animasi {
      position: relative;
      height: 80px;
      display: flex;
      justify-content: center;
      align-items: center;
      overflow: hidden;
    }

    .header-animasi::before {
      content: "";
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 255, 255, 0.1), transparent);
      animation: scan-header 3s linear infinite;
    }

    #teksSelamatDatang {
      font-family: 'Orbitron', monospace;
      font-size: 1.8rem;
      color: var(--primary);
      text-shadow: 0 0 5px var(--primary), 0 0 10px var(--primary);
      animation: text-flicker 1.5s infinite alternate, terminal-glow 4s infinite alternate;
      letter-spacing: 2px;
      padding: 10px 15px;
      border-top: 1px solid var(--primary);
      border-bottom: 1px solid var(--primary);
    }

    @media (max-width: 768px) {
      #teksSelamatDatang {
        font-size: 1.6rem;
        letter-spacing: 1px;
      }
    }

    @media (max-width: 480px) {
      #teksSelamatDatang {
        font-size: 1.4rem;
        padding: 8px 12px;
      }
    }

    @keyframes scan-header {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    @keyframes text-flicker {
      0% { opacity: 0.9; }
      5% { opacity: 0.7; }
      10% { opacity: 0.9; }
      15% { opacity: 0.6; }
      20% { opacity: 0.9; }
      100% { opacity: 0.9; }
    }

    @keyframes terminal-glow {
      0% { text-shadow: 0 0 5px var(--primary), 0 0 10px var(--primary); }
      100% { text-shadow: 0 0 10px var(--primary), 0 0 20px var(--primary), 0 0 30px rgba(0, 255, 255, 0.5); }
    }

    /* =============== KOTAK PENCARIAN =============== */
    #kotakPencarian {
      width: 100%;
      max-width: 550px;
      height: 50px;
      padding: 0 25px 0 50px;
      border: 1px solid var(--border-color);
      border-radius: 0;
      background-color: var(--panel);
      color: var(--text-primary);
      font-family: 'Courier New', monospace;
      font-size: 16px;
      outline: none;
      transition: all 0.3s ease;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='18' height='18' viewBox='0 0 24 24' fill='none' stroke='%2300ffff' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Ccircle cx='11' cy='11' r='8'%3E%3C/circle%3E%3Cline x1='21' y1='21' x2='16.65' y2='16.65'%3E%3C/line%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: 20px center;
      box-shadow:
        inset 0 0 10px rgba(0, 0, 0, 0.5),
        0 0 5px rgba(0, 255, 255, 0.2);
    }

    #kotakPencarian::placeholder {
      color: var(--text-secondary);
      font-style: italic;
    }

    #kotakPencarian:focus {
      border-color: var(--primary);
      box-shadow:
        inset 0 0 10px rgba(0, 255, 255, 0.3),
        0 0 15px rgba(0, 255, 255, 0.4);
    }

    .pencarian-loading::after {
      content: "";
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      width: 16px;
      height: 16px;
      border: 2px solid rgba(255, 255, 255, 0.2);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .pencarian-loading.active::after {
      opacity: 1;
    }

    @keyframes spin {
      to { transform: translateY(-50%) rotate(360deg); }
    }

    /* =============== GAYA KARTU =============== */
    .kontainer-kartu {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 30px;
      margin: 35px 0;
      width: 100%;
      max-width: 1250px;
    }

    .kartu {
      width: 320px;
      background-color: var(--panel);
      padding: 30px 25px;
      text-align: center;
      cursor: pointer;
      border: 1px solid var(--border-color);
      border-radius: 10px;
      transition: all 0.4s ease;
      position: relative;
      overflow: hidden;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.7), 0 5px 15px rgba(0, 0, 0, 0.5);
    }

    .kartu::before {
      content: "";
      position: absolute;
      width: 100%;
      height: 1px;
      top: 0;
      left: -100%;
      background: linear-gradient(90deg, transparent, var(--primary), transparent);
      animation: scan-hor 2s linear infinite;
    }

    .kartu::after {
      content: "";
      position: absolute;
      width: 1px;
      height: 100%;
      left: 0;
      top: -100%;
      background: linear-gradient(0deg, transparent, var(--secondary), transparent);
      animation: scan-ver 2s linear infinite;
    }

    @keyframes scan-hor { 0% { left: -100%; } 100% { left: 100%; } }
    @keyframes scan-ver { 0% { top: -100%; } 100% { top: 100%; } }

    .kartu:hover {
      transform: translateY(-10px) scale(1.03);
      border-color: var(--accent);
      box-shadow: 0 10px 25px rgba(51, 255, 51, 0.3), inset 0 0 20px rgba(0, 255, 255, 0.2);
    }

    .ikon-kartu {
      font-size: 3.5rem;
      margin-bottom: 25px;
      color: var(--primary);
      text-shadow: 0 0 10px var(--primary);
      filter: drop-shadow(0 0 5px rgba(102, 255, 255, 0.7));
      animation: icon-pulse 2s infinite alternate;
    }

    .kartu h2 {
      font-family: 'Orbitron', sans-serif;
      font-size: 1.4rem;
      color: var(--text-primary);
      margin-bottom: 15px;
      letter-spacing: 1px;
    }

    .kartu p {
      font-size: 0.95rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    @keyframes icon-pulse {
      0% { transform: scale(1); }
      100% { transform: scale(1.1); }
    }

    /* =============== INFO CONNECTION =============== */
    .info-container-modern {
      display: flex;
      justify-content: center;
      gap: 25px;
      width: 100%;
      max-width: 1200px;
      margin: 25px 0 20px 0;
      flex-wrap: wrap;
      padding: 0 10px;
    }

    .info-card-modern {
      display: flex;
      align-items: center;
      background: linear-gradient(145deg, var(--panel), var(--panel-highlight));
      color: var(--text-primary);
      padding: 20px;
      border-radius: 12px;
      box-shadow:
        0 0 15px rgba(0, 238, 255, 0.25),
        inset 0 0 12px rgba(0, 0, 0, 0.6);
      overflow: hidden;
      min-width: 280px;
      max-width: 100%;
      width: 100%;
      border: 1px solid var(--border-color);
      transition: all 0.35s cubic-bezier(0.165, 0.84, 0.44, 1);
      position: relative;
      backdrop-filter: blur(6px);
      box-sizing: border-box;
    }

    .info-card-modern:hover {
      transform: translateY(-5px) scale(1.01);
      box-shadow:
        0 7px 25px rgba(0, 238, 255, 0.4),
        inset 0 0 15px rgba(0, 0, 0, 0.7);
      border-color: var(--primary);
      z-index: 2;
    }

    .ip-card:hover {
      border-color: var(--accent);
      box-shadow:
        0 7px 25px rgba(0, 255, 0, 0.3),
        inset 0 0 15px rgba(0, 0, 0, 0.7);
    }

    .status-card:hover {
      border-color: var(--secondary);
      box-shadow:
        0 7px 25px rgba(255, 0, 255, 0.3),
        inset 0 0 15px rgba(0, 0, 0, 0.7);
    }

    .card-icon {
      font-size: 2.2rem;
      margin-right: 20px;
      color: var(--primary);
      text-shadow: 0 0 8px rgba(0, 255, 255, 0.5);
      transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
      filter: drop-shadow(0 0 2px rgba(0,0,0,0.7));
    }

    .info-card-modern:hover .card-icon {
      transform: scale(1.2);
      color: var(--secondary);
    }

    .ip-card:hover .card-icon {
      color: var(--accent);
      text-shadow: 0 0 8px rgba(0, 255, 0, 0.5);
    }

    .status-card:hover .card-icon {
      color: var(--secondary);
      text-shadow: 0 0 8px rgba(255, 0, 255, 0.5);
    }

    .card-content {
      flex: 1;
    }

    .card-content h3 {
      font-size: 1.1rem;
      margin: 0 0 8px 0;
      color: var(--text-primary);
      letter-spacing: 0.5px;
      text-shadow: 0 0 2px rgba(255, 255, 255, 0.1);
    }

    .card-content p,
    .card-content span {
      font-size: 1.2rem;
      margin: 0;
      font-family: 'Courier New', monospace;
      color: var(--accent);
      font-weight: bold;
      word-break: break-all;
    }

    .connection-status-modern {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 5px;
    }

    .status-indicator-modern {
      width: 12px;
      height: 12px;
      background-color: #00ff00;
      border-radius: 50%;
      box-shadow: 0 0 8px #00ff00;
      animation: pulse-modern 1.8s infinite ease-in-out;
    }

    @keyframes pulse-modern {
      0% { opacity: 0.6; transform: scale(1); }
      50% { opacity: 1; transform: scale(1.1); }
      100% { opacity: 0.6; transform: scale(1); }
    }

    .auto-update-modern {
      font-size: 0.75rem;
      color: var(--text-secondary);
      display: block;
      margin-top: 4px;
      font-style: italic;
    }

    @media (min-width: 769px) {
      .info-container-modern {
        max-width: 900px;
      }
      .info-card-modern {
        width: calc(50% - 12.5px);
      }
    }

    @media (max-width: 768px) {
      .info-container-modern {
        flex-direction: column;
        align-items: center;
        gap: 20px;
        margin: 20px 0 15px 0;
      }
      .info-card-modern {
        min-width: 90%;
        max-width: 95%;
        padding: 18px;
      }
    }

    @media (max-width: 480px) {
      .info-container-modern {
        margin: 15px 0 10px 0;
      }
      .info-card-modern {
        padding: 15px;
        min-width: 95%;
      }
      .card-icon {
        font-size: 1.8rem;
        margin-right: 15px;
      }
      .card-content h3 {
        font-size: 1rem;
      }
      .card-content p,
      .card-content span {
        font-size: 1.1rem;
      }
    }

    /* =============== TABEL =============== */
    #data1, #data2, #data3, #data4, #data5 {
      width: 100%;
      max-width: 1200px;
      margin: 30px auto;
      overflow-x: auto;
      display: none;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      background: rgba(17, 25, 40, 0.3);
      backdrop-filter: blur(12px);
      border: 1px solid rgba(0, 230, 255, 0.3);
      border-radius: 14px;
      overflow: hidden;
      box-shadow: 
        0 0 25px rgba(0, 230, 255, 0.2),
        inset 0 0 15px rgba(0, 230, 255, 0.1);
      font-size: 14px;
      position: relative;
    }

    th {
      background: linear-gradient(to bottom, rgba(0, 180, 255, 0.2), rgba(0, 100, 180, 0.1));
      color: #00f3ff;
      padding: 16px;
      text-align: center;
      font-weight: 600;
      border-bottom: 1px solid rgba(0, 230, 255, 0.4);
      text-shadow: 0 0 5px rgba(0, 230, 255, 0.7);
      letter-spacing: 0.5px;
    }

    td {
      padding: 14px 16px;
      text-align: center;
      color: white;
      border-bottom: 1px solid rgba(100, 150, 255, 0.1);
      transition: all 0.3s ease;
    }

    tr:hover td {
      background: rgba(0, 255, 200, 0.1);
      color: #00ff9d;
      box-shadow: inset 0 0 12px rgba(0, 255, 157, 0.2);
      transform: scale(1.01);
    }

    @keyframes scan-table {	
      0% { background-position: 0 0; }	
      100% { background-position: 0 100px; }	
    }

    /* =============== GAYA TOMBOL COPY =============== */
    .teks-copy {
      cursor: pointer;
      user-select: none;
      color: var(--light);
      border: 1px solid #ffa500;
      border-radius: 5px;
      padding: 8px 15px;
      background: rgba(138, 43, 226, 0.2);
      transition: all 0.3s ease;
      min-width: 70px;
      display: inline-block;
      text-align: center;
    }

    .teks-copy:hover {
      color: var(--secondary);
      border-color: var(--secondary);
      background: rgba(255, 0, 102, 0.3);
    }

    .teks-copy.disalin {
      background: rgba(0, 255, 0, 0.2) !important;
      border-color: green !important;
      min-width: 70px;
    }

    /* =============== GAYA KOLOM KHUSUS =============== */
    .kolom-penyelesaian, .kolom-jawaban {
      max-width: 700px;
      text-align: left;
      white-space: pre-line;
      word-wrap: break-word;
      padding: 14px 15px;
      line-height: 1.7;
      color: var(--text-primary);
      font-family: 'Courier New', monospace;
      font-size: 14px;
    }

    .kolom-pertanyaan {
      max-width: 400px;
      background: rgba(255,255,255,0.03);
      text-align: left;
      padding: 14px 15px;
      border-left: 3px solid var(--primary);
      line-height: 1.7;
      position: relative;
    }

    .kolom-pertanyaan::before {
      content: ">>";
      position: absolute;
      left: -25px;
      color: var(--accent);
      font-size: 12px;
    }

    .judul-bagian {
      text-align: center;
      background-color: var(--panel-highlight);
      color: var(--primary);
      font-weight: 600;
      font-size: 1.1rem;
      padding: 18px;
      border-bottom: 2px solid var(--primary);
      text-shadow: 0 0 5px var(--primary);
      letter-spacing: 1px;
      position: relative;
    }

    .judul-bagian::before, .judul-bagian::after {
      content: "[";
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      color: var(--secondary);
      font-weight: bold;
    }

    .judul-bagian::before { left: 15px; }
    .judul-bagian::after { content: "]"; right: 15px; }

    /* =============== PESAN TIDAK DITEMUKAN =============== */
    #pesanTidakDitemukan {
      display: none;
      text-align: center;
      font-size: 1.6rem;
      color: var(--secondary);
      margin-top: 40px;
      padding: 30px;
      background: rgba(255, 0, 255, 0.05);
      border: 1px dashed var(--secondary);
      width: 100%;
      max-width: 600px;
      animation: error-pulse 2s infinite;
    }

    #pesanTidakDitemukan i {
      font-size: 2rem;
      margin-bottom: 15px;
      display: block;
      color: var(--accent);
    }

    @keyframes error-pulse {
      0% { box-shadow: 0 0 5px rgba(255, 0, 255, 0.3); }
      50% { box-shadow: 0 0 20px rgba(255, 0, 255, 0.6); }
      100% { box-shadow: 0 0 5px rgba(255, 0, 255, 0.3); }
    }

    @keyframes scan-content {
      0% { background-position: 0 0; }
      100% { background-position: 0 100px; }
    }

    @media (max-width: 1024px) {
      .kartu { width: calc(50% - 20px); }
    }

    @media (max-width: 768px) {
      body { flex-direction: column; }
      .konten-utama { padding: 20px 15px; }
      .kontainer-kartu { gap: 20px; }
      .kartu { width: 100%; padding: 25px 20px; }
      #teksSelamatDatang { font-size: 2rem; }
      #kotakPencarian { max-width: 100%; height: 45px; font-size: 15px; }
      .header-animasi { height: 70px; }
      table { font-size: 14px; }
      th, td { padding: 12px 10px; }
    }

    @media (max-width: 480px) {
      .konten-utama { padding: 15px; }
      .kartu { padding: 20px 15px; }
      .ikon-kartu { font-size: 2.8rem; margin-bottom: 20px; }
      .kartu h2 { font-size: 1.2rem; }
      #teksSelamatDatang { font-size: 1.6rem; }
    }
  </style>
</head>
<body>

  <!-- Konten Utama -->
  <div class="konten-utama">
    <div class="header">
      <div class="header-animasi">
        <h1 id="teksSelamatDatang"></h1>
      </div>
      <input type="text" placeholder="INPUT_QUERY >>" id="kotakPencarian" onkeyup="cariTabel()">
    </div>

    <!-- Info Connection Cards -->
    <div class="info-container">
      <div class="info-card">
        <h3>IP Address</h3>
        <p id="ip-address">103.197.240.20</p>
      </div>
      <div class="info-card">
        <h3>Status Koneksi</h3>
        <div class="connection-status">
          <span class="status-indicator"></span>
          <span id="connection-status">209 ms</span>
        </div>
        <span class="auto-update">updater every time </span>
      </div>
    </div>

    <!-- Kontainer Kartu -->
    <div id="kontainerKartu" class="kontainer-kartu">
      <!-- PERHITUNGAN TOGEL -->
      <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbxsw1X2L0rus3wLjy9ubhkaZkkCaJZrIiDtpbnXq5Si8WuwfATlB7NO5XrBOgIhGne9/exec', '_blank')">
        <div class="ikon-kartu">
          <i class="fa-solid fa-file-contract"></i>
        </div>
        <h2>SUM TOGEL</h2>
        <p>Access terms and conditions for togel sum</p>
      </div>

      <!-- JADWAL TOGEL -->
      <div class="kartu" onclick="tampilkanjadwalpasarantogel()">
        <div class="ikon-kartu">
          <i class="fa-solid fa-calendar-days"></i>
        </div>
        <h2>TOGEL SCHEDULE</h2>
        <p>Complete schedule of today's markets</p>
      </div>

      <!-- EVENT MAHJONG -->
      <div class="kartu" onclick="tampilkanevenscatter()">
        <div class="ikon-kartu">
          <i class="fa-solid fa-dice"></i>
        </div>
        <h2>MAHJONG EVENTS</h2>
        <p>Special freespin and buyspin events</p>
      </div>

      <!-- GAMEPLAY TOGEL -->
      <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbxoTBdSa4wCpqcoOhgh1YLHzkrVtD00sJBab1YI43jiEmuFBGvwI_ucOA_H7BKLZZzRJQ/exec', '_blank')">
        <div class="ikon-kartu">
          <i class="fas fa-dice-one"></i>
        </div>
        <h2>GAMEPLAY TOGEL</h2>
        <p>Manage your gameplay togel </p>
      </div>

      <!-- LIVECASINO GAMEPLAY -->
      <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbwzVyNFFYbOyuTMFm37kVeUve6gxivZ-9zZTXt58YgHsLwe5fTpJ25kxXjWH2hKNLo-hQ/exec', '_blank')">
        <div class="ikon-kartu">
          <i class="fas fa-puzzle-piece"></i>
        </div>
        <h2>LIVECASINO GAMEPLAY</h2>
        <p>Manage your Livecasino gameplay </p>
      </div>

      <!-- GAME PLAY SLOT -->
      <div class="kartu" onclick="window.open('https://script.google.com/macros/s/AKfycbzgA3lUfKKHhhKjSYyLtqBJr2pAAUPv53nXde6VU_BR06CeFpsJZl-nbhYQ6uc2Oxl-/exec', '_blank')">
        <div class="ikon-kartu">
          <i class="fas fa-cubes"></i>
        </div>
        <h2>GAME PLAY SLOT</h2>
        <p>Manage your GAME PLAY SLOT </p>
      </div>
    </div>

    <!-- Data Tables -->
    <div id="data1"></div>
    <div id="data2"></div>
    <div id="data3"></div>
    <div id="data4"></div>
    <div id="data5"></div>

    <!-- Pesan Tidak Ditemukan -->
    <div id="pesanTidakDitemukan">
      <i class="fas fa-exclamation-triangle"></i>
      <div>
        <strong>DATA_NOT_FOUND</strong><br>
        <small style="color: var(--text-secondary);">Try again Bong</small>
      </div>
    </div>
  </div>

  <script>
    // =============== VARIABEL GLOBAL ===============
    let kategoriSekarang = '';
    let semuaData = {
      datalogin: [], linknawala: [], bonus: [], report: [], hadiah: []
    };
    let terakhirDiperbarui = '';
    let sedangMencari = false;
    let intervalPembaruan;

    // =============== INISIALISASI ===============
    window.onload = function() {
      const loadingTimeout = setTimeout(() => {
        tampilkanError("Timeout: Gagal memuat data. Silakan coba refresh.");
      }, 30000);

      google.script.run
        .withSuccessHandler(function(response) {
          clearTimeout(loadingTimeout);
          handleSuksesMuatData(response);
          tampilkanMenuUtama();
          mulaiAnimasiTeksSelamatDatang();
          mulaiPembaruanOtomatis();
        })
        .withFailureHandler(function(error) {
          clearTimeout(loadingTimeout);
          handleGagalMuatData(error);
        })
        .getSheetData();
    };

    // =============== FUNGSI PEMUATAN DATA ===============
    function muatData() {
      tampilkanIndikatorPencarian(true);
      google.script.run
        .withSuccessHandler(function(response) {
          handleSuksesMuatData(response);
          tampilkanIndikatorPencarian(false);
        })
        .withFailureHandler(function(error) {
          handleGagalMuatData(error);
          tampilkanIndikatorPencarian(false);
          tampilkanNotifikasi("Gagal memuat data terbaru", "error");
        })
        .getSheetData();
    }

    function handleSuksesMuatData(response) {
      if (response.error) {
        tampilkanError(response.error);
        return;
      }
      semuaData = {
        datalogin: response.sheet1Data || [],
        linknawala: response.sheet2Data || [],
        bonus: response.sheet3Data || [],
        report: response.sheet4Data || [],
        hadiah: response.sheet5Data || []
      };
      terakhirDiperbarui = response.lastUpdated || '';
    }

    function handleGagalMuatData(error) {
      console.error("Error:", error);
      tampilkanError("Gagal memuat data. Silakan coba refresh halaman.");
    }

    // =============== SISTEM NOTIFIKASI ===============
    function tampilkanNotifikasi(pesan, tipe = "info") {
      const colors = {
        info: "var(--primary)",
        success: "#4CAF50",
        warning: "#FFC107",
        error: "#F44336"
      };
      const icons = {
        info: "fas fa-info-circle",
        success: "fas fa-check-circle",
        warning: "fas fa-exclamation-triangle",
        error: "fas fa-times-circle"
      };
      const notifikasi = document.createElement("div");
      notifikasi.className = `notifikasi ${tipe}`;
      notifikasi.innerHTML = `
        <i class="${icons[tipe]}"></i>
        <span>${pesan}</span>
      `;
      document.body.appendChild(notifikasi);
      setTimeout(() => {
        notifikasi.style.animation = "slideOut 0.3s ease-in";
        setTimeout(() => {
          document.body.removeChild(notifikasi);
        }, 300);
      }, 3000);
    }

    function tampilkanError(pesan) {
      tampilkanNotifikasi(pesan, "error");
    }

    // =============== FUNGSI PENCARIAN ===============
    function cariTabel() {
      if (sedangMencari) return;
      const input = document.getElementById('kotakPencarian').value.toLowerCase().trim();
      document.getElementById('pesanTidakDitemukan').style.display = 'none';
      if (input.length < 2) {
        filterKategori(kategoriSekarang);
        return;
      }
      sedangMencari = true;
      document.getElementById('kotakPencarian').classList.add('pencarian-loading', 'active');
      setTimeout(() => {
        let ditemukan = false;
        if (kategoriSekarang && semuaData[kategoriSekarang] && semuaData[kategoriSekarang].length > 0) {
          const hasilFilter = filterData(semuaData[kategoriSekarang], input);
          const elementId = `data${['datalogin', 'linknawala', 'bonus', 'report', 'hadiah'].indexOf(kategoriSekarang) + 1}`;
          tampilkanDataFilter(elementId, hasilFilter, kategoriSekarang);
          ditemukan = hasilFilter.length > 1;
        }
        if (!ditemukan && input.length > 0) {
          document.getElementById('pesanTidakDitemukan').style.display = 'block';
        }
        sedangMencari = false;
        document.getElementById('kotakPencarian').classList.remove('active');
      }, 300);
    }

    function filterData(data, query) {
      if (!query || !data || data.length === 0) return data;
      const filtered = [data[0]];
      const termsPencarian = query.split(' ').filter(term => term.length > 0);
      for (let i = 1; i < data.length; i++) {
        const teksBaris = data[i].join(' ').toLowerCase();
        const semuaTermDitemukan = termsPencarian.every(term =>
          teksBaris.includes(term)
        );
        if (semuaTermDitemukan) {
          filtered.push(data[i]);
        }
      }
      return filtered;
    }

    function tampilkanDataFilter(elementId, data, kategori) {
      const element = document.getElementById(elementId);
      if (data.length > 1) {
        element.innerHTML = buatTabel(data, kategori);
        element.style.display = 'block';
      } else {
        element.style.display = 'none';
      }
    }

    // =============== PEMBUATAN TABEL ===============
    function buatTabel(data, kategori) {
      if (!data || data.length < 2) {
        return '<p style="color:#ff0066;text-align:center;">Tidak ada data tersedia</p>';
      }
      let table = `<table>`;
      if (kategori === 'bonus') {
        let judulSekarang = '';
        for (let i = 1; i < data.length; i++) {
          const judul = data[i][0];
          const kendala = data[i][1];
          const penyelesaian = data[i][2];
          if (!judul && !kendala && !penyelesaian) continue;
          if (judul && judul !== judulSekarang) {
            table += `<tr>
              <td colspan="3" class="judul-bagian">${escapeHTML(judul)}</td>
            </tr>`;
            judulSekarang = judul;
          }
          if (kendala && penyelesaian) {
            const escapedPenyelesaian = escapeKarakterKhusus(penyelesaian);
            const modifiedKendala = escapeHTML(kendala).replace(/
/g, "<br>");
            table += `<tr>
              <td class="kolom-pertanyaan">${modifiedKendala}</td>
              <td class="kolom-penyelesaian">${escapeHTML(penyelesaian)}</td>
              <td style="vertical-align: middle;">
                <span class="teks-copy" onclick="salinPenyelesaian('${escapedPenyelesaian}', this)">Salin</span>
              </td>
            </tr>`;
          }
        }
      } else if (kategori === 'report') {
        let judulSekarang = '';
        for (let i = 1; i < data.length; i++) {
          const judul = data[i][0];
          const keterangan = data[i][1];
          const jawaban = data[i][2];
          if (!judul && !keterangan && !jawaban) continue;
          if (judul && judul !== judulSekarang) {
            table += `<tr>
              <td colspan="3" class="judul-bagian">${escapeHTML(judul)}</td>
            </tr>`;
            judulSekarang = judul;
          }
          if (keterangan && jawaban) {
            const escapedJawaban = escapeKarakterKhusus(jawaban);
            table += `<tr>
              <td class="kolom-pertanyaan">${escapeHTML(keterangan)}</td>
              <td class="kolom-jawaban">${escapeHTML(jawaban)}</td>
              <td style="vertical-align: middle;">
                <span class="teks-copy" onclick="salinJawaban('${escapedJawaban}', this)">Salin</span>
              </td>
            </tr>`;
          }
        }
      } else if (kategori === 'hadiah') {
        let judulSekarang = '';
        for (let i = 1; i < data.length; i++) {
          const judul = data[i][0];
          const pertanyaan = data[i][1];
          const jawaban = data[i][2];
          if (!judul && !pertanyaan && !jawaban) continue;
          if (judul && judul !== judulSekarang) {
            table += `<tr>
              <td colspan="3" class="judul-bagian">${escapeHTML(judul)}</td>
            </tr>`;
            judulSekarang = judul;
          }
          if (pertanyaan && jawaban) {
            const escapedJawaban = escapeKarakterKhusus(jawaban);
            const modifiedPertanyaan = escapeHTML(pertanyaan).replace(/
/g, "<br>");
            table += `<tr>
              <td class="kolom-pertanyaan">${modifiedPertanyaan}</td>
              <td class="kolom-jawaban">${escapeHTML(jawaban)}</td>
              <td style="vertical-align: middle;">
                <span class="teks-copy" onclick="salinJawaban('${escapedJawaban}', this)">Salin</span>
              </td>
            </tr>`;
          }
        }
      } else {
        table += '<tr>';
        data[0].forEach(footer => {
          table += `<th>${escapeHTML(footer)}</th>`;
        });
        table += '</tr>';
        for (let i = 1; i < data.length; i++) {
          table += '<tr>';
          data[i].forEach(cell => {
            table += `<td>${escapeHTML(cell) || '-'}</td>`;
          });
          table += '</tr>';
        }
      }
      table += '</table>';
      return table;
    }

    // =============== FUNGSI UTILITAS ===============
    function escapeHTML(str) {
      if (!str) return '';
      return str.toString()
        .replace(/&/g, '&amp;')
        .replace(/</g, '<')
        .replace(/>/g, '>')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#39;');
    }

    function escapeKarakterKhusus(text) {
      if (!text) return '';
      return text.toString()
        .replace(/\\/g, '\\\\')
        .replace(/'/g, "\\'")
        .replace(/"/g, '\\"')
        .replace(/
/g, '\
')
        .replace(/\r/g, '\\r')
        .replace(/\t/g, '\\t');
    }

    // =============== FUNGSI SALIN ===============
    function salinPenyelesaian(text, element) {
      const unescaped = text
        .replace(/\\'/g, "'")
        .replace(/\\"/g, '"')
        .replace(/\
/g, '
')
        .replace(/\\r/g, '\r')
        .replace(/\\t/g, '\t')
        .replace(/\\\\/g, '\\');
      salinKeClipboard(unescaped, element);
    }

    function salinJawaban(text, element) {
      const unescaped = text
        .replace(/\\'/g, "'")
        .replace(/\\"/g, '"')
        .replace(/\
/g, '
')
        .replace(/\\\\/g, '\\');
      salinKeClipboard(unescaped, element);
    }

    function salinKeClipboard(text, element) {
      const textarea = document.createElement('textarea');
      textarea.value = text;
      textarea.style.position = 'fixed';
      document.body.appendChild(textarea);
      textarea.select();
      try {
        if (navigator.clipboard) {
          navigator.clipboard.writeText(text).then(() => {
            tampilkanFeedbackSalin(element, true);
          }).catch(() => {
            fallbackSalin(textarea, element);
          });
        } else {
          fallbackSalin(textarea, element);
        }
      } catch (err) {
        console.error("Gagal menyalin:", err);
        tampilkanFeedbackSalin(element, false);
      } finally {
        document.body.removeChild(textarea);
      }
    }

    function fallbackSalin(textarea, element) {
      try {
        const berhasil = document.execCommand('copy');
        tampilkanFeedbackSalin(element, berhasil);
      } catch (err) {
        console.error("Fallback salin gagal:", err);
        tampilkanFeedbackSalin(element, false);
      }
    }

    function tampilkanFeedbackSalin(element, isSuccess) {
      const teksAsli = element.textContent;
      const lebarAsli = element.offsetWidth;
      element.innerHTML = isSuccess
        ? '<i class="fas fa-check"></i> Disalin!'
        : '<i class="fas fa-times"></i> Error!';
      element.classList.add('disalin');
      element.style.minWidth = lebarAsli + 'px';
      setTimeout(() => {
        element.innerHTML = teksAsli;
        element.classList.remove('disalin');
        element.style.minWidth = '';
      }, 2000);
    }

    // =============== FUNGSI NAVIGASI ===============
    function filterKategori(kategori) {
      kategoriSekarang = kategori;
      tampilkanKotakPencarian();
      document.querySelectorAll('#data1, #data2, #data3, #data4, #data5').forEach(el => {
        el.style.display = 'none';
      });
      const data = semuaData[kategori];
      if (data && data.length > 1) {
        const elementId = `data${['datalogin', 'linknawala', 'bonus', 'report', 'hadiah'].indexOf(kategori) + 1}`;
        document.getElementById(elementId).style.display = 'table';
        document.getElementById(elementId).innerHTML = buatTabel(data, kategori);
      }
      document.getElementById('kontainerKartu').style.display = 'none';
      document.getElementById('teksSelamatDatang').style.display = 'none';
      document.getElementById('pesanTidakDitemukan').style.display = 'none';
    }

    function tampilkanMenuUtama() {
      kategoriSekarang = '';
      sembunyikanKotakPencarian();
      document.querySelectorAll('#data1, #data2, #data3, #data4, #data5').forEach(el => {
        el.style.display = 'none';
      });
      document.getElementById('kontainerKartu').style.display = 'flex';
      document.getElementById('teksSelamatDatang').style.display = 'block';
      document.getElementById('pesanTidakDitemukan').style.display = 'none';
    }

    function tampilkanKotakPencarian() {
      document.getElementById('kotakPencarian').style.display = 'block';
      document.getElementById('kotakPencarian').focus();
    }

    function sembunyikanKotakPencarian() {
      document.getElementById('kotakPencarian').style.display = 'none';
      document.getElementById('kotakPencarian').value = '';
    }

    // =============== ANIMASI TEKS SELAMAT DATANG ===============
    function mulaiAnimasiTeksSelamatDatang() {
      const teksSelamatDatang = document.getElementById('teksSelamatDatang');
      const texts = ["Hallo bosku,Welcome My Dashboard"];
      let count = 0;
      let index = 0;
      let isDeleting = false;
      let speed = 1000;
      function type() {
        const currentText = texts[count];
        if (isDeleting) {
          teksSelamatDatang.textContent = currentText.substring(0, index - 1);
          index--;
          speed = 50;
        } else {
          teksSelamatDatang.textContent = currentText.substring(0, index + 1);
          index++;
          speed = 150;
        }
        if (!isDeleting && index === currentText.length) {
          isDeleting = true;
          speed = 2000;
        } else if (isDeleting && index === 0) {
          isDeleting = false;
          count = (count + 1) % texts.length;
          speed = 500;
        }
        setTimeout(type, speed);
      }
      type();
    }

    // Simulasi auto-update status koneksi
    function updateConnectionStatus() {
      const statusElement = document.getElementById('connection-status');
      const latency = Math.floor(Math.random() * 100) + 50;
      statusElement.textContent = `${latency} ms`;
      const indicator = document.querySelector('.status-indicator');
      if (latency < 100) {
        indicator.style.backgroundColor = '#00ff00';
        indicator.style.boxShadow = '0 0 8px #00ff00';
      } else if (latency < 200) {
        indicator.style.backgroundColor = '#ffff00';
        indicator.style.boxShadow = '0 0 8px #ffff00';
      } else {
        indicator.style.backgroundColor = '#ff9900';
        indicator.style.boxShadow = '0 0 8px #ff9900';
      }
    }

    // Inisialisasi
    window.onload = function() {
      mulaiAnimasiTeksSelamatDatang();
      setInterval(updateConnectionStatus, 1000);
      updateConnectionStatus();
    };

    // =============== PEMBARUAN OTOMATIS ===============
    function mulaiPembaruanOtomatis() {
      if (intervalPembaruan) clearInterval(intervalPembaruan);
      intervalPembaruan = setInterval(() => {
        if (document.visibilityState === 'visible') {
          muatData();
        }
      }, 300000);
    }

    document.addEventListener('visibilitychange', () => {
      if (document.visibilityState === 'visible') {
        muatData();
        mulaiPembaruanOtomatis();
      }
    });

    // =============== LINK EKSTERNAL ===============
    function tampilkanjadwalpasarantogel() {
      window.open("https://script.google.com/macros/s/AKfycbws06QqbkB2ZzXLmqZS5Tb4cEB7BqO8B83tMwpQz08rINCEZ2Ts6AVNpHz5bySDAk1Z/exec", "_blank");
    }

    function tampilkanevenscatter() {
      window.open("https://script.google.com/macros/s/AKfycbzwEzajlfbQY-dO35YSPcb0ZlNsWNMvcwRlIYTMuCUeyPYow1ua3S155nUPhuVbu-lD/exec", "_blank");
    }

    // =============== FUNGSI BANTUAN ===============
    function tampilkanIndikatorPencarian(show) {
      const kotakPencarian = document.getElementById('kotakPencarian');
      if (show) {
        kotakPencarian.classList.add('pencarian-loading', 'active');
      } else {
        kotakPencarian.classList.remove('active');
      }
    }
  </script>
</body>
</html>

